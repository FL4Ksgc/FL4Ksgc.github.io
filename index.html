<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-xcpc板子" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/01/xcpc%E6%9D%BF%E5%AD%90/" class="article-date">
  <time class="dt-published" datetime="2024-10-01T05:47:23.417Z" itemprop="datePublished">2024-10-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h1><h2 id="STL工具"><a href="#STL工具" class="headerlink" title="STL工具"></a>STL工具</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//vector</span></span><br><span class="line">vector&lt;<span class="type">int</span>&gt; a;</span><br><span class="line">a.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">a.<span class="built_in">pop_back</span>();</span><br><span class="line"><span class="built_in">sort</span>(a.<span class="built_in">begin</span>(),a.<span class="built_in">end</span>()<span class="comment">/*最后一个元素+1的指针*/</span>);</span><br><span class="line">a.<span class="built_in">clear</span>();</span><br><span class="line">a.<span class="built_in">empty</span>();</span><br><span class="line">a.<span class="built_in">size</span>();</span><br><span class="line">a.<span class="built_in">front</span>();a.<span class="built_in">back</span>();</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; b;a.<span class="built_in">swap</span>(b)<span class="comment">//交换两vector</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//map</span></span><br><span class="line">map&lt;<span class="type">int</span>,string&gt; a;</span><br><span class="line">a[<span class="number">1</span>]=<span class="string">&quot;a&quot;</span>;</span><br><span class="line">a.<span class="built_in">insert</span>(<span class="built_in">pair</span>&lt;<span class="type">int</span>,string&gt;(<span class="number">2</span>,<span class="string">&quot;b&quot;</span>));</span><br><span class="line">a.<span class="built_in">empty</span>();</span><br><span class="line">a.<span class="built_in">size</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//set</span></span><br><span class="line">set&lt;<span class="type">int</span>&gt; a;</span><br><span class="line">a.<span class="built_in">insert</span>(<span class="number">1</span>);</span><br><span class="line">a.<span class="built_in">erase</span>(<span class="number">1</span>);</span><br><span class="line">a.<span class="built_in">empty</span>()</span><br><span class="line">a.<span class="built_in">size</span>()</span><br><span class="line"><span class="keyword">auto</span> it=a.<span class="built_in">find</span>(<span class="number">1</span>);<span class="comment">//查找某个元素的迭代器，不存在则返回a.end()</span></span><br><span class="line"><span class="keyword">if</span>(it!=a.<span class="built_in">end</span>()) cout&lt;&lt;<span class="string">&quot;Yes&quot;</span>&lt;&lt;endl;</span><br><span class="line">a.<span class="built_in">count</span>(<span class="number">1</span>);</span><br><span class="line">a.<span class="built_in">lower_bound</span>(<span class="number">1</span>)<span class="comment">//第一个&gt;=的迭代器</span></span><br><span class="line">a.<span class="built_in">upper_bound</span>(<span class="number">1</span>)<span class="comment">//第一个&gt;的迭代器</span></span><br><span class="line"><span class="comment">//(set会将元素自动排序)</span></span><br><span class="line"><span class="comment">//遍历方式1</span></span><br><span class="line">set&lt;<span class="type">int</span>&gt;::iterator it;<span class="comment">//迭代器</span></span><br><span class="line"><span class="keyword">for</span>(it=a.<span class="built_in">begin</span>();i!=a.<span class="built_in">end</span>()<span class="comment">/*最后一个元素+1的指针*/</span>;i++)<span class="comment">//自加</span></span><br><span class="line">    cout&lt;&lt;*it&lt;&lt;endl;</span><br><span class="line"><span class="comment">//遍历方式2</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> i=a.<span class="built_in">begin</span>();i!=a.<span class="built_in">end</span>();i++)</span><br><span class="line">    cout&lt;&lt;*i&lt;&lt;endl;</span><br><span class="line"><span class="comment">//遍历方式3</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> i:a) </span><br><span class="line">    cout&lt;&lt;i&lt;&lt;endl;</span><br><span class="line"><span class="comment">//multiset(与set基本相同)</span></span><br><span class="line">multiset&lt;<span class="type">int</span>&gt; a;</span><br><span class="line"><span class="comment">//二分工具</span></span><br><span class="line">ans1=<span class="built_in">lower_bound</span>(a<span class="number">+1</span>,a+n<span class="number">+1</span>,<span class="number">10</span>)-a;</span><br><span class="line">ans2=<span class="built_in">upper_bound</span>(a<span class="number">+1</span>,a+n<span class="number">+1</span>,<span class="number">10</span>)-a;</span><br><span class="line">ans3=<span class="built_in">unique</span>(a<span class="number">+1</span>,a+n<span class="number">+1</span>)<span class="number">-1</span>-a;<span class="comment">//要-1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="质因数分解"><a href="#质因数分解" class="headerlink" title="质因数分解"></a>质因数分解</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">breakdown</span><span class="params">(<span class="type">int</span> N)</span> </span>&#123;</span><br><span class="line">  vector&lt;<span class="type">int</span>&gt; result;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i * i &lt;= N; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (N % i == <span class="number">0</span>) &#123;  <span class="comment">// 如果 i 能够整除 N，说明 i 为 N 的一个质因子。</span></span><br><span class="line">      <span class="keyword">while</span> (N % i == <span class="number">0</span>) N /= i;</span><br><span class="line">      result.<span class="built_in">push_back</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (N != <span class="number">1</span>) &#123;  <span class="comment">// 说明再经过操作之后 N 留下了一个素数</span></span><br><span class="line">    result.<span class="built_in">push_back</span>(N);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="裴蜀定理"><a href="#裴蜀定理" class="headerlink" title="裴蜀定理"></a>裴蜀定理</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ax+bx=c有解，当且仅当c=k*gcd(a,b)</span></span><br><span class="line"><span class="comment">//ax+bx=c (mod m)有解，当且仅当c=k*gcd(a,b) (mod m)</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> y?</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="built_in">main</span>() &#123;</span><br><span class="line">	<span class="comment">//构造xi，使ai*xi之和最小，答案为gcd(所有ai)</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>, tmp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;tmp);</span><br><span class="line">        <span class="keyword">if</span>(tmp &lt; <span class="number">0</span>) tmp = -tmp;<span class="comment">//取反不影响结果</span></span><br><span class="line">        ans = <span class="built_in">gcd</span>(ans, tmp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, ans);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="exgcd"><a href="#exgcd" class="headerlink" title="exgcd"></a>exgcd</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> y?<span class="built_in">gcd</span>(y,x%y):x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">exgcd</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> &amp;x,<span class="type">int</span> &amp;y)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> d=a;</span><br><span class="line">	<span class="keyword">if</span>(b==<span class="number">0</span>)&#123;</span><br><span class="line">		x=<span class="number">1</span>,y=<span class="number">0</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		d=<span class="built_in">exgcd</span>(b,a%b,y,x),y=y-a/b*x;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//求出ax+by=c的正整数解，无则输出-1</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> T;cin&gt;&gt;T;</span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line">		<span class="type">int</span> a,b,c,x,y;</span><br><span class="line">		cin&gt;&gt;a&gt;&gt;b&gt;&gt;c;</span><br><span class="line">		<span class="comment">//ax+by=c</span></span><br><span class="line">		<span class="type">int</span> d=<span class="built_in">exgcd</span>(a,b,x,y);<span class="comment">//exgcd求出特解(右为gcd版)</span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(c%d!=<span class="number">0</span>)&#123;</span><br><span class="line">			cout&lt;&lt;<span class="number">-1</span>&lt;&lt;endl;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		x*=c/d,y*=c/d;</span><br><span class="line">		<span class="type">int</span> p=b/d,q=a/d;<span class="comment">//a(x+k*p)+b(y-k*q)=c</span></span><br><span class="line">		<span class="type">int</span> k;</span><br><span class="line">		<span class="keyword">if</span>(x&lt;<span class="number">0</span>) k=<span class="built_in">ceil</span>((<span class="number">1.0</span>-x)/p),x+=p*k,y-=q*k;</span><br><span class="line">		<span class="keyword">if</span>(x&gt;=<span class="number">0</span>) k=(x<span class="number">-1</span>)/p,x-=p*k,y+=q*k;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(y&lt;=<span class="number">0</span>)&#123;</span><br><span class="line">			cout&lt;&lt;x&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;y+q*(<span class="type">int</span>)<span class="built_in">ceil</span>((<span class="number">1.0</span>-y)/q);</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			cout&lt;&lt;(y<span class="number">-1</span>)/q<span class="number">+1</span>&lt;&lt;<span class="string">&quot; &quot;</span>;<span class="comment">//解的数量</span></span><br><span class="line">			cout&lt;&lt;x&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;(y<span class="number">-1</span>)%q<span class="number">+1</span>&lt;&lt;<span class="string">&quot; &quot;</span>;<span class="comment">//Xmin Ymax</span></span><br><span class="line">			cout&lt;&lt;x+(y<span class="number">-1</span>)/q*p&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;y;<span class="comment">//Xmax Ymin</span></span><br><span class="line">		&#125;</span><br><span class="line">		cout&lt;&lt;endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>![24ac77f71a63fa5d0572e476e5d4b79](C:\Users\m1368\Documents\WeChat Files\wxid_8ixqik1qpezg22\FileStorage\Temp\24ac77f71a63fa5d0572e476e5d4b79.png)</p>
<h2 id="欧拉函数"><a href="#欧拉函数" class="headerlink" title="欧拉函数"></a>欧拉函数</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">euler_phi</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = n;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i * i &lt;= n; i++)</span><br><span class="line">    <span class="keyword">if</span> (n % i == <span class="number">0</span>) &#123;</span><br><span class="line">      ans = ans / i * (i - <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">while</span> (n % i == <span class="number">0</span>) n /= i;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">if</span> (n &gt; <span class="number">1</span>) ans = ans / n * (n - <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="欧拉定理"><a href="#欧拉定理" class="headerlink" title="欧拉定理"></a>欧拉定理</h2><p>![463751c854eac7d4860515ae789265b](C:\Users\m1368\Documents\WeChat Files\wxid_8ixqik1qpezg22\FileStorage\Temp\463751c854eac7d4860515ae789265b.png)</p>
<h2 id="扩展欧拉定理"><a href="#扩展欧拉定理" class="headerlink" title="扩展欧拉定理"></a>扩展欧拉定理</h2><p>![09a3d2c802d8a5851cea5ffa2c623b1](C:\Users\m1368\Documents\WeChat Files\wxid_8ixqik1qpezg22\FileStorage\Temp\09a3d2c802d8a5851cea5ffa2c623b1.png)</p>
<h2 id="crt"><a href="#crt" class="headerlink" title="crt"></a>crt</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n,a[<span class="number">500000</span><span class="number">+5</span>],b[<span class="number">500000</span><span class="number">+5</span>],M=<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Exgcd</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span>&amp; d,<span class="type">int</span>&amp; x,<span class="type">int</span>&amp; y)</span> </span>&#123;<span class="comment">//ax+by</span></span><br><span class="line">    <span class="keyword">if</span>(!b) &#123;</span><br><span class="line">        d=a;x=<span class="number">1</span>;y=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">Exgcd</span>(b,a%b,d,x,y);</span><br><span class="line">        <span class="type">int</span> newx=y,newy=x-(a/b)*y;</span><br><span class="line">        x=newx;y=newy;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">IntChina</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ret=<span class="number">0</span>,Mi,x,y,d;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) &#123;</span><br><span class="line">        Mi=M/a[i];</span><br><span class="line">        <span class="built_in">Exgcd</span>(Mi,a[i],d,x,y);</span><br><span class="line">        <span class="comment">//x:Mi*x=1(mod mi)的一个解</span></span><br><span class="line">        ret=((ret+Mi*x*b[i])%M+M)%M;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) &#123;</span><br><span class="line">        cin&gt;&gt;a[i]&gt;&gt;b[i];</span><br><span class="line">        <span class="comment">//ans%a[i]=b[i]</span></span><br><span class="line">        M*=a[i];<span class="comment">//M:所有模数之积</span></span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;<span class="built_in">IntChina</span>()&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>![b3dd61893487281889a85cb91d09f37](C:\Users\m1368\Documents\WeChat Files\wxid_8ixqik1qpezg22\FileStorage\Temp\b3dd61893487281889a85cb91d09f37.png)</p>
<h2 id="excrt"><a href="#excrt" class="headerlink" title="excrt"></a>excrt</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n,a[<span class="number">100000</span><span class="number">+5</span>],b[<span class="number">100000</span><span class="number">+5</span>],M;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qmul</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> MOD)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ret=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(y) &#123;</span><br><span class="line">        <span class="keyword">if</span>(y&amp;<span class="number">1</span>) ret=(ret+x)%MOD;</span><br><span class="line">        y&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">        x=(x+x)%MOD;</span><br><span class="line">    &#125;<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Exgcd</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span>&amp; d,<span class="type">int</span>&amp; x,<span class="type">int</span>&amp; y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b) &#123;</span><br><span class="line">        d=a;x=<span class="number">1</span>;y=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">Exgcd</span>(b,a%b,d,x,y);</span><br><span class="line">        <span class="type">int</span> newx=y,newy=x-(a/b)*y;</span><br><span class="line">        x=newx;y=newy;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ExIntChina</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ret=b[<span class="number">1</span>],x,y,d;</span><br><span class="line">    <span class="type">int</span> M=a[<span class="number">1</span>];<span class="comment">//目前为止ai的lcm</span></span><br><span class="line">    <span class="comment">//维护一个x=ret(mod M)</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++) &#123;</span><br><span class="line">        <span class="type">int</span> c=((b[i]-ret)%a[i]+a[i])%a[i];</span><br><span class="line">        <span class="comment">//Mx + a[i]q = b[i] - ret</span></span><br><span class="line">        <span class="built_in">Exgcd</span>(M,a[i],d,x,y);</span><br><span class="line">        <span class="keyword">if</span>(c%d!=<span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        x=<span class="built_in">qmul</span>(x,c/d,a[i]/d);</span><br><span class="line">        ret+=M*x;<span class="comment">//更新ret</span></span><br><span class="line">        M*=(a[i]/d);</span><br><span class="line">        ret=(ret%M+M)%M;<span class="comment">//对新的模意义更新</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (ret%M+M)%M;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) &#123;</span><br><span class="line">        cin&gt;&gt;a[i]&gt;&gt;b[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//x%a[i]=b[i],a[i]不一定互质</span></span><br><span class="line">    cout&lt;&lt;<span class="built_in">ExIntChina</span>()&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="威尔逊定理"><a href="#威尔逊定理" class="headerlink" title="威尔逊定理"></a>威尔逊定理</h2><p>$$<br>对于素数p有(p-1)!&#x3D;-1(mod p)<br>$$</p>
<h2 id="卢卡斯定理"><a href="#卢卡斯定理" class="headerlink" title="卢卡斯定理"></a>卢卡斯定理</h2><p><img src="C:\Users\m1368\AppData\Roaming\Typora\typora-user-images\image-20240913190528301.png" alt="image-20240913190528301"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">Lucas</span><span class="params">(<span class="type">long</span> <span class="type">long</span> n, <span class="type">long</span> <span class="type">long</span> m, <span class="type">long</span> <span class="type">long</span> p)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (m == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> (<span class="built_in">C</span>(n % p, m % p, p) * <span class="built_in">Lucas</span>(n / p, m / p, p)) % p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="扩展卢卡斯定理"><a href="#扩展卢卡斯定理" class="headerlink" title="扩展卢卡斯定理"></a>扩展卢卡斯定理</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LL <span class="title">calc</span><span class="params">(LL n, LL x, LL P)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!n) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  LL s = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (LL i = <span class="number">1</span>; i &lt;= P; i++)</span><br><span class="line">    <span class="keyword">if</span> (i % x) s = s * i % P;</span><br><span class="line">  s = <span class="built_in">Pow</span>(s, n / P, P);</span><br><span class="line">  <span class="keyword">for</span> (LL i = n / P * P + <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    <span class="keyword">if</span> (i % x) s = i % P * s % P;</span><br><span class="line">  <span class="keyword">return</span> s * <span class="built_in">calc</span>(n / x, x, P) % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">multilucas</span><span class="params">(LL m, LL n, LL x, LL P)</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (LL i = m; i; i /= x) cnt += i / x;</span><br><span class="line">  <span class="keyword">for</span> (LL i = n; i; i /= x) cnt -= i / x;</span><br><span class="line">  <span class="keyword">for</span> (LL i = m - n; i; i /= x) cnt -= i / x;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Pow</span>(x, cnt, P) % P * <span class="built_in">calc</span>(m, x, P) % P * <span class="built_in">inverse</span>(<span class="built_in">calc</span>(n, x, P), P) %</span><br><span class="line">         P * <span class="built_in">inverse</span>(<span class="built_in">calc</span>(m - n, x, P), P) % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">exlucas</span><span class="params">(LL m, LL n, LL P)</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">  LL p[<span class="number">20</span>], a[<span class="number">20</span>];</span><br><span class="line">  <span class="keyword">for</span> (LL i = <span class="number">2</span>; i * i &lt;= P; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (P % i == <span class="number">0</span>) &#123;</span><br><span class="line">      p[++cnt] = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">while</span> (P % i == <span class="number">0</span>) p[cnt] = p[cnt] * i, P /= i;</span><br><span class="line">      a[cnt] = <span class="built_in">multilucas</span>(m, n, i, p[cnt]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (P &gt; <span class="number">1</span>) p[++cnt] = P, a[cnt] = <span class="built_in">multilucas</span>(m, n, P, P);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">CRT</span>(cnt, a, p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="二分法"><a href="#二分法" class="headerlink" title="二分法"></a>二分法</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">l是大于寻找元素的第一个元素</span></span><br><span class="line"><span class="comment">（不存在l会为n）</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">int</span> l=<span class="number">1</span>,r=m,mid;</span><br><span class="line"><span class="keyword">while</span>(l&lt;r)&#123;</span><br><span class="line">	mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(a[mid]&lt;=seek)</span><br><span class="line">       l=mid<span class="number">+1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">       r=mid;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="三分法"><a href="#三分法" class="headerlink" title="三分法"></a>三分法</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">double</span> <span class="title">f</span><span class="params">(<span class="type">double</span> a)</span></span>&#123;<span class="comment">/*根据题目意思计算*/</span>&#125;</span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">three</span><span class="params">(<span class="type">double</span> l,<span class="type">double</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(l+EPS&lt;r)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">double</span> mid=l+(r-l)/<span class="number">3</span>;</span><br><span class="line">        <span class="type">double</span> midmid=r-(r-l)/<span class="number">3</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">f</span>(mid)&gt;<span class="built_in">f</span>(midmid)) r=midmid;</span><br><span class="line">        <span class="keyword">else</span> l=mid;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">double</span> left, right, m1, m2, m1_value, m2_value;</span><br><span class="line">    left = MIN;</span><br><span class="line">    right = MAX;</span><br><span class="line">    <span class="keyword">while</span> (left + EPS &lt; right)&#123;</span><br><span class="line">        m1 = left + (right - left)/<span class="number">3</span>;</span><br><span class="line">        m2 = right - (right - left)/<span class="number">3</span>;</span><br><span class="line">        m1_value = <span class="built_in">f</span>(m1);</span><br><span class="line">        m2_value = <span class="built_in">f</span>(m2);</span><br><span class="line">        <span class="keyword">if</span> (m1_value &gt;= m2_value)</span><br><span class="line">            right = m2;  <span class="comment">//假设求解极大值</span></span><br><span class="line">        <span class="keyword">else</span>  left = m1; </span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h2 id="高斯消元"><a href="#高斯消元" class="headerlink" title="高斯消元"></a>高斯消元</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> db EPS = <span class="number">1E-8</span>;</span><br><span class="line">ll n;</span><br><span class="line">db a[N][N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	n = <span class="built_in">read</span>();</span><br><span class="line">	<span class="keyword">for</span> (ll i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">		<span class="keyword">for</span> (ll j = <span class="number">0</span>; j &lt;= n; j++)</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;a[i][j]);</span><br><span class="line">	<span class="keyword">for</span> (ll i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">		ll p = i;</span><br><span class="line">		<span class="keyword">for</span> (ll j = i; j &lt; n; j++)</span><br><span class="line">			<span class="keyword">if</span> (<span class="built_in">fabs</span>(a[j][i] - a[p][i]) &lt;= EPS) p = j;</span><br><span class="line">		<span class="keyword">for</span> (ll j = <span class="number">0</span>; j &lt;= n; j++) &#123;</span><br><span class="line">			db t = a[i][j];</span><br><span class="line">			a[i][j] = a[p][j];</span><br><span class="line">			a[p][j] = t;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">fabs</span>(a[i][i]) &lt;= EPS) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;No Solution\n&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		db div = a[i][i];</span><br><span class="line">		<span class="keyword">for</span> (ll j = i + <span class="number">1</span>; j &lt;= n; j++) a[i][j] /= div;</span><br><span class="line">		<span class="keyword">for</span> (ll j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">			<span class="keyword">if</span> (i != j)</span><br><span class="line">				<span class="keyword">for</span> (ll k = i + <span class="number">1</span>; k &lt;= n; k++) </span><br><span class="line">					a[j][k] -= a[j][i] * a[i][k];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (ll i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%.2lf\n&quot;</span>, a[i][n]);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="线性基"><a href="#线性基" class="headerlink" title="线性基"></a>线性基</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=N;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">		<span class="keyword">if</span>(x&amp;(<span class="number">1ll</span>&lt;&lt;i))&#123;</span><br><span class="line">			<span class="keyword">if</span>(!p[i])&#123;</span><br><span class="line">				p[i]=x;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> x=x^p[i];</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=N;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j=i<span class="number">-1</span>;j&gt;=<span class="number">0</span>;j--)</span><br><span class="line">			<span class="keyword">if</span>(p[i]&amp;(<span class="number">1ll</span>&lt;&lt;j))</span><br><span class="line">				p[i]^=p[j];</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=N;i++)</span><br><span class="line">		<span class="keyword">if</span>(p[i])</span><br><span class="line">			d[cnt++]=p[i];<span class="comment">//d下标从0开始</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(k&gt;=(<span class="number">1ll</span>&lt;&lt;cnt)) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	<span class="type">int</span> ret=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=N<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">		<span class="keyword">if</span>(k&amp;(<span class="number">1ll</span>&lt;&lt;i)) ret^=d[i];</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Max</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">kth</span>((<span class="number">1ll</span>&lt;&lt;cnt)<span class="number">-1</span>);<span class="comment">//默认不能选0个</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) cin&gt;&gt;a[i],<span class="built_in">insert</span>(a[i]);</span><br><span class="line">	<span class="built_in">build</span>();</span><br><span class="line"><span class="comment">/*	int K;</span></span><br><span class="line"><span class="comment">	cin&gt;&gt;K;</span></span><br><span class="line"><span class="comment">	cout&lt;&lt;kth(K)&lt;&lt;endl;*/</span></span><br><span class="line">	cout&lt;&lt;<span class="built_in">Max</span>()&lt;&lt;endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="堆优化dijkstra"><a href="#堆优化dijkstra" class="headerlink" title="堆优化dijkstra"></a>堆优化dijkstra</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">priority_queue&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt; q;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dijkstra</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) d[i]=MAXN;<span class="comment">//d[i]初始为INF </span></span><br><span class="line">	d[s]=<span class="number">0</span>;<span class="comment">//d[1]初始为0 </span></span><br><span class="line">	q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(<span class="number">0</span>,s));</span><br><span class="line">	<span class="keyword">while</span>(q.<span class="built_in">size</span>())&#123;</span><br><span class="line">		<span class="type">int</span> x=q.<span class="built_in">top</span>().second;q.<span class="built_in">pop</span>();</span><br><span class="line">		<span class="keyword">if</span>(v[x]) <span class="keyword">continue</span>;</span><br><span class="line">		v[x]=<span class="number">1</span>;<span class="comment">//每个点只拓展一遍 </span></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=Next[i])&#123;</span><br><span class="line">			<span class="type">int</span> y=ver[i],z=edge[i];</span><br><span class="line">			<span class="keyword">if</span>(d[x]+z&lt;d[y])&#123;</span><br><span class="line">				d[y]=d[x]+z;</span><br><span class="line">				q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(-d[y],y));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="差分约束"><a href="#差分约束" class="headerlink" title="差分约束"></a>差分约束</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">spfa</span><span class="params">()</span></span>&#123;</span><br><span class="line">	queue&lt;<span class="type">int</span>&gt; q;<span class="comment">//SPFA使用普通队列 </span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) dis[i]=INF;</span><br><span class="line">	q.<span class="built_in">push</span>(<span class="number">0</span>);v[<span class="number">0</span>]=<span class="number">1</span>;push_cnt[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(q.<span class="built_in">size</span>())&#123;</span><br><span class="line">		<span class="type">int</span> x=q.<span class="built_in">front</span>();q.<span class="built_in">pop</span>();</span><br><span class="line">		v[x]=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=Next[i])&#123;</span><br><span class="line">			<span class="type">int</span> y=ver[i],z=val[i];</span><br><span class="line">			<span class="keyword">if</span>(dis[y]&gt;dis[x]+z)&#123;</span><br><span class="line">				dis[y]=dis[x]+z;</span><br><span class="line">				<span class="keyword">if</span>(!v[y])&#123;<span class="comment">//不管怎样都更新dis[y]，但是必须不存在queue中才能加入queue </span></span><br><span class="line">					q.<span class="built_in">push</span>(y);v[y]=<span class="number">1</span>;push_cnt[y]++;</span><br><span class="line">					<span class="keyword">if</span>(push_cnt[y]&gt;=n)<span class="comment">//这个点已经被入queue了n次 </span></span><br><span class="line">						<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">		<span class="type">int</span> x, y, z;</span><br><span class="line">		cin &gt;&gt; x &gt;&gt; y &gt;&gt; z;</span><br><span class="line">		<span class="built_in">insert</span>(y, x, z);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++) </span><br><span class="line">		<span class="built_in">insert</span>(<span class="number">0</span>, i, <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">if</span> (!<span class="built_in">spfa</span>()) <span class="built_in">printf</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) min_dis = <span class="built_in">min</span>(min_dis, dis[i]);</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, dis[i] - min_dis);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h2 id="负环"><a href="#负环" class="headerlink" title="负环"></a>负环</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">spfa</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) dis[i] = INF;</span><br><span class="line">	queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">	dis[<span class="number">1</span>] = <span class="number">0</span>; vis[<span class="number">1</span>] = <span class="number">1</span>; q.<span class="built_in">push</span>(<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">while</span> (q.<span class="built_in">size</span>()) &#123;</span><br><span class="line">		<span class="type">int</span> x = q.<span class="built_in">front</span>(); vis[x] = <span class="number">0</span>; q.<span class="built_in">pop</span>();</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = head[x]; i; i = Next[i]) &#123;</span><br><span class="line">			<span class="type">int</span> y = ver[i];</span><br><span class="line">			<span class="keyword">if</span> (dis[x] + val[i] &lt; dis[y]) &#123;</span><br><span class="line">				dis[y] = dis[x] + val[i];</span><br><span class="line">				<span class="keyword">if</span> (!vis[y]) &#123;</span><br><span class="line">					<span class="keyword">if</span> (++incnt[y] &gt;= n) &#123;<span class="comment">//入队n次以上，即说明存在负环</span></span><br><span class="line">						cout &lt;&lt; <span class="string">&quot;YES&quot;</span> &lt;&lt; endl;</span><br><span class="line">						<span class="keyword">return</span>;</span><br><span class="line">					&#125;</span><br><span class="line">					vis[y] = <span class="number">1</span>; q.<span class="built_in">push</span>(y);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;NO&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="分块"><a href="#分块" class="headerlink" title="分块"></a>分块</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ll n, m, a[N], sum[N], L[N], R[N], add[N], pos[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(ll l, ll r, ll d)</span> </span>&#123;</span><br><span class="line">	<span class="type">int</span> p = pos[l], q = pos[r];</span><br><span class="line">	<span class="keyword">if</span> (p == q) &#123;</span><br><span class="line">		<span class="built_in">For</span>(i, l, r) a[i] += d;</span><br><span class="line">		sum[p] += d * (r - l + <span class="number">1</span>);</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="built_in">For</span>(i, p + <span class="number">1</span>, q - <span class="number">1</span>) add[i] += d;</span><br><span class="line">		<span class="built_in">For</span>(i, l, R[p]) a[i] += d; sum[p] += (R[p] - l + <span class="number">1</span>) * d;</span><br><span class="line">		<span class="built_in">For</span>(i, L[q], r) a[i] += d; sum[q] += (r - L[q] + <span class="number">1</span>) * d;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(ll l, ll r)</span> </span>&#123;</span><br><span class="line">	ll p = pos[l], q = pos[r], ret = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span> (p == q) &#123;</span><br><span class="line">		<span class="built_in">For</span>(i, l, r) ret += a[i];</span><br><span class="line">		ret += add[p] * (r - l + <span class="number">1</span>);</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="built_in">For</span>(i, p + <span class="number">1</span>, q - <span class="number">1</span>) ret += sum[i] + add[i] * (R[i] - L[i] + <span class="number">1</span>);</span><br><span class="line">		<span class="built_in">For</span>(i, l, R[p]) ret += a[i]; ret += add[p] * (R[p] - l + <span class="number">1</span>);</span><br><span class="line">		<span class="built_in">For</span>(i, L[q], r) ret += a[i]; ret += add[q] * (r - L[q] + <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	n = <span class="built_in">read</span>(), m = <span class="built_in">read</span>();</span><br><span class="line">	<span class="built_in">For</span>(i, <span class="number">1</span>, n) a[i] = <span class="built_in">read</span>();</span><br><span class="line">	ll t = <span class="built_in">sqrt</span>(n);</span><br><span class="line">	<span class="built_in">For</span>(i, <span class="number">1</span>, t) L[i] = (i - <span class="number">1</span>) * t + <span class="number">1</span>, R[i] = i * t;</span><br><span class="line">	<span class="keyword">if</span> (R[t] &lt; n) t++, L[t] = R[t - <span class="number">1</span>] + <span class="number">1</span>, R[t] = n;</span><br><span class="line">	<span class="built_in">For</span>(i, <span class="number">1</span>, t) &#123;</span><br><span class="line">		<span class="built_in">For</span>(j, L[i], R[i]) </span><br><span class="line">			pos[j] = i, sum[i] += a[j];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span> (m--) &#123;</span><br><span class="line">		ll op = <span class="built_in">read</span>(), x, y, k;</span><br><span class="line">		<span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">			x = <span class="built_in">read</span>(), y = <span class="built_in">read</span>(), k = <span class="built_in">read</span>(); <span class="built_in">change</span>(x, y, k);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			x = <span class="built_in">read</span>(), y = <span class="built_in">read</span>(); <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">ask</span>(x, y));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h2 id="树状数组"><a href="#树状数组" class="headerlink" title="树状数组"></a>树状数组</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lowbit(x) ((x) &amp; (-x))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN 500010</span></span><br><span class="line"><span class="type">int</span> tree[MAXN], a[MAXN], n, m;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">while</span> (x &lt;= n) &#123;</span><br><span class="line">		tree[x] += k;</span><br><span class="line">		x += <span class="built_in">lowbit</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (x) &#123;</span><br><span class="line">		sum += tree[x];</span><br><span class="line">		x -= <span class="built_in">lowbit</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">update</span>(i, a[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="type">int</span> mode, l, r, x, k;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">	<span class="built_in">build</span>();</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;mode);</span><br><span class="line">		<span class="keyword">if</span> (mode == <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;k);</span><br><span class="line">			<span class="built_in">update</span>(x, k);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">query</span>(r) - <span class="built_in">query</span>(l - <span class="number">1</span>));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="割点"><a href="#割点" class="headerlink" title="割点"></a>割点</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">	dfn[x] = low[x] = ++num;</span><br><span class="line">	ll flag = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (ll i = head[x]; i; i = e[i].Next) &#123;</span><br><span class="line">		ll y = e[i].ver;</span><br><span class="line">		<span class="keyword">if</span> (!dfn[y]) &#123;</span><br><span class="line">			<span class="built_in">tarjan</span>(y);</span><br><span class="line">			low[x] = <span class="built_in">min</span>(low[x], low[y]);</span><br><span class="line">			<span class="keyword">if</span> (low[y] &gt;= dfn[x]) &#123;</span><br><span class="line">				flag++;</span><br><span class="line">				<span class="keyword">if</span> (x != root || flag &gt; <span class="number">1</span>)</span><br><span class="line">					cut[x] = <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">else</span></span><br><span class="line">			low[x] = <span class="built_in">min</span>(low[x], dfn[y]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="缩点"><a href="#缩点" class="headerlink" title="缩点"></a>缩点</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">	dfn[x] = low[x] = ++times;</span><br><span class="line">	stac[++top] = x;</span><br><span class="line">	instac[x] = <span class="number">1</span>;<span class="comment">//标记当前节点在栈里 </span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = head[x]; i; i = e[i].Next) &#123;</span><br><span class="line">		<span class="type">int</span> y = e[i].y;</span><br><span class="line">		<span class="keyword">if</span> (!dfn[y]) &#123;</span><br><span class="line">			<span class="built_in">tarjan</span>(y);</span><br><span class="line">			low[x] = <span class="built_in">min</span>(low[y], low[x]);</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (!belong[y]) &#123;<span class="comment">//或写成 if(instac[y])</span></span><br><span class="line">			low[x] = <span class="built_in">min</span>(low[x], dfn[y]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (dfn[x] == low[x]) &#123;<span class="comment">//弹出栈里元素直至当前访问到的节点 </span></span><br><span class="line">		sccnum++;</span><br><span class="line">		<span class="keyword">while</span> (stac[top] != x) &#123;</span><br><span class="line">			belong[stac[top]] = sccnum;<span class="comment">//染色 </span></span><br><span class="line">			sum[sccnum] += a[stac[top]];<span class="comment">//计入新scc的点权和 </span></span><br><span class="line">			instac[stac[top]] = <span class="number">0</span>;<span class="comment">//出栈 </span></span><br><span class="line">			top--;</span><br><span class="line">		&#125;</span><br><span class="line">		belong[stac[top]] = sccnum;</span><br><span class="line">		sum[sccnum] += a[stac[top]];</span><br><span class="line">		instac[stac[top]] = <span class="number">0</span>;</span><br><span class="line">		top--;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (f[x]) <span class="keyword">return</span>;</span><br><span class="line">	f[x] = sum[x];</span><br><span class="line">	<span class="type">int</span> maxnum = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = head[x]; i; i = e[i].Next) &#123;</span><br><span class="line">		<span class="type">int</span> y = e[i].y;</span><br><span class="line">		<span class="keyword">if</span> (!f[y]) <span class="built_in">dfs</span>(y);</span><br><span class="line">		maxnum = <span class="built_in">max</span>(maxnum, f[y]);</span><br><span class="line">	&#125;</span><br><span class="line">	f[x] += maxnum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cin &gt;&gt; a[i];</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">		<span class="type">int</span> xx, yy;</span><br><span class="line">		cin &gt;&gt; xx &gt;&gt; yy;</span><br><span class="line">		x[i] = xx; y[i] = yy;<span class="comment">//先把每条边保存到数组里，后面会用到 </span></span><br><span class="line">		<span class="built_in">insert</span>(xx, yy);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">if</span> (!dfn[i]) <span class="built_in">tarjan</span>(i);<span class="comment">//图不一定联通，所以要每个节点检查遍历 </span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//清空原图，开始建新图 </span></span><br><span class="line">	<span class="built_in">memset</span>(head, <span class="number">0</span>, <span class="built_in">sizeof</span>(head));</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++) &#123;</span><br><span class="line">		e[i].Next = <span class="number">0</span>; e[i].x = <span class="number">0</span>; e[i].y = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	cnt = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (belong[x[i]] != belong[y[i]]) &#123; </span><br><span class="line">			<span class="built_in">insert</span>(belong[x[i]], belong[y[i]]);<span class="comment">//连接scc </span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= sccnum; i++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (!f[i]) &#123;</span><br><span class="line">			<span class="built_in">dfs</span>(i);</span><br><span class="line">			ans = <span class="built_in">max</span>(ans, f[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; ans;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="虚树"><a href="#虚树" class="headerlink" title="虚树"></a>虚树</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sort</span>(a<span class="number">+1</span>,a+k<span class="number">+1</span>,cmp);</span><br><span class="line">      stk[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">      <span class="type">int</span> top=<span class="number">1</span>;</span><br><span class="line">      t<span class="number">2.</span>head[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=k;i++)&#123;<span class="comment">//k个关键点</span></span><br><span class="line">          <span class="type">int</span> lca=<span class="built_in">getlca</span>(a[i],stk[top]);</span><br><span class="line">          <span class="keyword">if</span>(lca!=stk[top])&#123;</span><br><span class="line">              <span class="keyword">while</span>(dfn[lca]&lt;dfn[stk[top<span class="number">-1</span>]])&#123;</span><br><span class="line">                  <span class="type">int</span> x=stk[top<span class="number">-1</span>],y=stk[top];</span><br><span class="line">                  <span class="built_in">getlca</span>(x,y);</span><br><span class="line">                  t<span class="number">2.</span><span class="built_in">insert</span>(x,y,d);</span><br><span class="line">                  top--;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">if</span>(dfn[lca]&gt;dfn[stk[top<span class="number">-1</span>]])&#123;</span><br><span class="line">                  <span class="built_in">getlca</span>(lca,stk[top]);</span><br><span class="line">                  t<span class="number">2.</span>head[lca]=<span class="number">0</span>;</span><br><span class="line">                  t<span class="number">2.</span><span class="built_in">insert</span>(lca,stk[top],d);</span><br><span class="line">                  top--;</span><br><span class="line">                  stk[++top]=lca;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">else</span>&#123;<span class="comment">//dfn[lca]=dfn[stk[top-1]]</span></span><br><span class="line">                  <span class="type">int</span> x=stk[top<span class="number">-1</span>],y=stk[top];</span><br><span class="line">                  <span class="built_in">getlca</span>(x,y);</span><br><span class="line">                  t<span class="number">2.</span><span class="built_in">insert</span>(x,y,d);</span><br><span class="line">                  top--;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          t<span class="number">2.</span>head[a[i]]=<span class="number">0</span>;</span><br><span class="line">          stk[++top]=a[i];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span>(top&gt;<span class="number">1</span>)&#123;</span><br><span class="line">          <span class="type">int</span> x=stk[top<span class="number">-1</span>],y=stk[top];</span><br><span class="line">          <span class="built_in">getlca</span>(x,y);</span><br><span class="line">          t<span class="number">2.</span><span class="built_in">insert</span>(x,y,d);</span><br><span class="line">          top--;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>



<h2 id="点分治"><a href="#点分治" class="headerlink" title="点分治"></a>点分治</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e4</span><span class="number">+5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> K=<span class="number">1e7</span><span class="number">+5</span>;</span><br><span class="line"><span class="type">int</span> n,m,head[N],cnt;</span><br><span class="line"><span class="type">int</span> ask[<span class="number">205</span>],ok[<span class="number">205</span>];</span><br><span class="line"><span class="type">int</span> rt,mx[N],vis[N],siz[N];</span><br><span class="line"><span class="type">int</span> dis[N],a[N],b[N];</span><br><span class="line"><span class="type">int</span> cont;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span>&#123;</span><br><span class="line">    <span class="type">int</span> v,w,Next;</span><br><span class="line">&#125;e[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span>&#123;</span><br><span class="line">    cnt++;e[cnt].Next=head[x];head[x]=cnt;e[cnt].v=y;e[cnt].w=z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="type">int</span> &amp;x,<span class="type">int</span> &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> dis[x]&lt;dis[y];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">getrt</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> from,<span class="type">int</span> tot)</span></span>&#123;</span><br><span class="line">    siz[x]=<span class="number">1</span>;</span><br><span class="line">    mx[x]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=e[i].Next)&#123;</span><br><span class="line">        <span class="type">int</span> y=e[i].v,z=e[i].w;</span><br><span class="line">        <span class="keyword">if</span>(y==from||vis[y]) <span class="keyword">continue</span>;<span class="comment">//vis=1说明不在此子树中</span></span><br><span class="line">        <span class="built_in">getrt</span>(y,x,tot);</span><br><span class="line">        siz[x]+=siz[y];</span><br><span class="line">        mx[x]=<span class="built_in">max</span>(mx[x],siz[y]);</span><br><span class="line">    &#125;</span><br><span class="line">    mx[x]=<span class="built_in">max</span>(mx[x],tot-siz[x]);</span><br><span class="line">    <span class="keyword">if</span>(!rt||mx[x]&lt;mx[rt])</span><br><span class="line">        rt=x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">getdis</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> from,<span class="type">int</span> nowdis,<span class="type">int</span> bl)</span></span>&#123;<span class="comment">//以目前rt为根的深度</span></span><br><span class="line">    a[++cont]=x;</span><br><span class="line">    dis[x]=nowdis;</span><br><span class="line">    b[x]=bl;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=e[i].Next)&#123;</span><br><span class="line">        <span class="type">int</span> y=e[i].v,z=e[i].w;</span><br><span class="line">        <span class="keyword">if</span>(y==from||vis[y]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">getdis</span>(y,x,nowdis+z,bl);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">calc</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    cont=<span class="number">0</span>;</span><br><span class="line">    a[++cont]=x;dis[x]=<span class="number">0</span>;b[x]=x;<span class="comment">//要合并的答案包括rt</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=e[i].Next)&#123;</span><br><span class="line">        <span class="type">int</span> y=e[i].v,z=e[i].w;</span><br><span class="line">        <span class="keyword">if</span>(vis[y]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">getdis</span>(y,x,z,y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(a<span class="number">+1</span>,a+cont<span class="number">+1</span>,cmp);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">        <span class="type">int</span> l=<span class="number">1</span>,r=cont;<span class="comment">//cont:当前合并答案的总量</span></span><br><span class="line">        <span class="keyword">if</span>(ok[i]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">while</span>(l&lt;r)&#123;<span class="comment">//尺取法</span></span><br><span class="line">            <span class="keyword">if</span>(dis[a[l]]+dis[a[r]]&gt;ask[i]) r--;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(dis[a[l]]+dis[a[r]]&lt;ask[i]) l++;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(b[a[l]]==b[a[r]])&#123;<span class="comment">//dis[a[l]]+dis[a[r]]==ask[i],但答案不分别在两个子树</span></span><br><span class="line">                <span class="keyword">if</span>(dis[a[r]]==dis[a[r<span class="number">-1</span>]]) r--;</span><br><span class="line">                <span class="keyword">else</span> l++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                ok[i]=<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="comment">//点分治</span></span><br><span class="line">    vis[x]=<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">calc</span>(x);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=e[i].Next)&#123;</span><br><span class="line">        <span class="type">int</span> y=e[i].v;</span><br><span class="line">        <span class="keyword">if</span>(vis[y]) <span class="keyword">continue</span>;</span><br><span class="line">        rt=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">getrt</span>(y,<span class="number">0</span>,siz[y]);</span><br><span class="line">        <span class="built_in">solve</span>(rt);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="type">int</span> x,y,z;</span><br><span class="line">        cin&gt;&gt;x&gt;&gt;y&gt;&gt;z;</span><br><span class="line">        <span class="built_in">insert</span>(x,y,z);</span><br><span class="line">        <span class="built_in">insert</span>(y,x,z);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">        cin&gt;&gt;ask[i];</span><br><span class="line">        <span class="keyword">if</span>(!ask[i]) ok[i]=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    rt=<span class="number">0</span>;</span><br><span class="line">    mx[rt]=n;</span><br><span class="line">    <span class="built_in">getrt</span>(<span class="number">1</span>,<span class="number">0</span>,n);</span><br><span class="line">    <span class="built_in">solve</span>(rt);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(ok[i]) cout&lt;&lt;<span class="string">&quot;AYE\n&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span> cout&lt;&lt;<span class="string">&quot;NAY\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-SAT"><a href="#2-SAT" class="headerlink" title="2-SAT"></a>2-SAT</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	dfn[x]=low[x]=++dfncnt;</span><br><span class="line">	stk[++top]=x;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=Next[i])&#123;</span><br><span class="line">		<span class="type">int</span> y=ver[i];</span><br><span class="line">		<span class="keyword">if</span>(!dfn[y])&#123;</span><br><span class="line">			<span class="built_in">tarjan</span>(y);</span><br><span class="line">			low[x]=<span class="built_in">min</span>(low[x],low[y]);<span class="comment">//</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(!col[y])&#123;</span><br><span class="line">			low[x]=<span class="built_in">min</span>(low[x],dfn[y]);<span class="comment">//</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(low[x]==dfn[x])&#123;<span class="comment">//给一个scc染色</span></span><br><span class="line">		colnum++;</span><br><span class="line">		<span class="keyword">while</span>(stk[top]!=x)</span><br><span class="line">			col[stk[top--]]=colnum;</span><br><span class="line">		col[stk[top--]]=colnum;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">		<span class="type">int</span> x,a,y,b;</span><br><span class="line">		cin&gt;&gt;x&gt;&gt;a&gt;&gt;y&gt;&gt;b;</span><br><span class="line">		<span class="comment">//i  :1</span></span><br><span class="line">		<span class="comment">//i+n:0</span></span><br><span class="line">		<span class="built_in">insert</span>(x+n*(a^<span class="number">1</span>),y+n*b);</span><br><span class="line">		<span class="built_in">insert</span>(y+n*(b^<span class="number">1</span>),x+n*a);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n*<span class="number">2</span>;i++)</span><br><span class="line">		<span class="keyword">if</span>(!dfn[i])</span><br><span class="line">			<span class="built_in">tarjan</span>(i);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">		<span class="keyword">if</span>(col[i]==col[i+n])&#123;</span><br><span class="line">			cout&lt;&lt;<span class="string">&quot;IMPOSSIBLE\n&quot;</span>;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	cout&lt;&lt;<span class="string">&quot;POSSIBLE\n&quot;</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">		<span class="keyword">if</span>(col[i]&gt;col[i+n]) cout&lt;&lt;<span class="string">&quot;1 &quot;</span>;</span><br><span class="line">		<span class="keyword">else</span> cout&lt;&lt;<span class="string">&quot;0 &quot;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="二分图最大匹配"><a href="#二分图最大匹配" class="headerlink" title="二分图最大匹配"></a>二分图最大匹配</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">dfs</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = head[x]; i; i = e[i].Next) &#123;</span><br><span class="line">		ll y = e[i].ver;</span><br><span class="line">		<span class="keyword">if</span> (vis[y]) <span class="keyword">continue</span>; </span><br><span class="line">		vis[y] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (!mat[y] || <span class="built_in">dfs</span>(mat[y])) &#123;</span><br><span class="line">			mat[y] = x; <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Match</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">		<span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">dfs</span>(i)) ans++;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ST表"><a href="#ST表" class="headerlink" title="ST表"></a>ST表</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ll query(ll l, ll r) &#123;</span><br><span class="line">	ll lg2 = log2(r - l + <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">max</span>(f[l][lg2], f[r - (<span class="number">1</span> &lt;&lt; lg2) + <span class="number">1</span>][lg2]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">int</span> main() &#123;</span><br><span class="line">	n = read(); m = read();</span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>; i &lt;= n; i++) f[i][<span class="number">0</span>] = read();</span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">20</span>; j++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= n; i++) &#123;</span><br><span class="line">			f[i][j] = <span class="built_in">max</span>(f[i][j - <span class="number">1</span>], f[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span> (m--) &#123;</span><br><span class="line">		ll l = read(), r = read();</span><br><span class="line">		printf(<span class="string">&quot;%lld\n&quot;</span>, query(l, r));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="扫描线"><a href="#扫描线" class="headerlink" title="扫描线"></a>扫描线</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="type">int</span> n,tmp[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	ll l,r,h,mark;</span><br><span class="line">&#125;line[N];</span><br><span class="line"><span class="type">bool</span> <span class="keyword">operator</span> &lt;(<span class="type">const</span> node &amp;x,<span class="type">const</span> node &amp;y)&#123;</span><br><span class="line">	<span class="keyword">return</span> x.h&lt;y.h;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tree</span>&#123;</span><br><span class="line">	ll tag,len;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="comment">//tag</span></span><br><span class="line"><span class="comment">//len</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(t[x].tag) t[x].len=tmp[r<span class="number">+1</span>]-tmp[l];<span class="comment">//有tag，是还在被覆盖中的</span></span><br><span class="line">	<span class="keyword">else</span>&#123;<span class="comment">//无覆盖</span></span><br><span class="line">		t[x].len=t[x&lt;&lt;<span class="number">1</span>].len+t[x&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].len;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R,<span class="type">int</span> c)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(tmp[r<span class="number">+1</span>]&lt;=L||R&lt;=tmp[l]) <span class="keyword">return</span>;</span><br><span class="line">	<span class="keyword">if</span>(L&lt;=tmp[l]&amp;&amp;tmp[r<span class="number">+1</span>]&lt;=R)&#123;</span><br><span class="line">		t[x].tag+=c;</span><br><span class="line">		<span class="built_in">pushup</span>(x,l,r);</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="built_in">change</span>(x&lt;&lt;<span class="number">1</span>,l,mid,L,R,c);</span><br><span class="line">	<span class="built_in">change</span>(x&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid<span class="number">+1</span>,r,L,R,c);</span><br><span class="line">	<span class="built_in">pushup</span>(x,l,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	/___/_/___/_/_/_____</span></span><br><span class="line"><span class="comment">	（r+1的原因）</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		<span class="type">int</span> a,b,c,d;</span><br><span class="line">		cin&gt;&gt;a&gt;&gt;b&gt;&gt;c&gt;&gt;d;<span class="comment">//x1 y1 x2 y2</span></span><br><span class="line">		tmp[i*<span class="number">2</span><span class="number">-1</span>]=a,tmp[i*<span class="number">2</span>]=c;</span><br><span class="line">		line[i*<span class="number">2</span><span class="number">-1</span>]=(node)&#123;a,c,b,<span class="number">1</span>&#125;;</span><br><span class="line">		line[i*<span class="number">2</span>]=(node)&#123;a,c,d,<span class="number">-1</span>&#125;;	</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">sort</span>(line<span class="number">+1</span>,line+n*<span class="number">2</span><span class="number">+1</span>);</span><br><span class="line">	<span class="built_in">sort</span>(tmp<span class="number">+1</span>,tmp+n*<span class="number">2</span><span class="number">+1</span>);</span><br><span class="line">	<span class="type">int</span> len=<span class="built_in">unique</span>(tmp<span class="number">+1</span>,tmp+n*<span class="number">2</span><span class="number">+1</span>)-tmp<span class="number">-1</span>;</span><br><span class="line"><span class="comment">//	build(1,1,len-1);//植树问题，线段数=点数-1 </span></span><br><span class="line">	ll ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n*<span class="number">2</span><span class="number">-1</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">change</span>(<span class="number">1</span>,<span class="number">1</span>,len<span class="number">-1</span>,line[i].l,line[i].r,line[i].mark);<span class="comment">//(1,1,len-1)!!!</span></span><br><span class="line">		ans+=t[<span class="number">1</span>].len*(line[i<span class="number">+1</span>].h-line[i].h);</span><br><span class="line">	&#125;</span><br><span class="line">	cout&lt;&lt;ans&lt;&lt;endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="树链剖分"><a href="#树链剖分" class="headerlink" title="树链剖分"></a>树链剖分</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ll n, m, root, mod;</span><br><span class="line">ll cnt, head[N];</span><br><span class="line">ll siz[N], top[N], dep[N], fa[N], num, id[N], son[N];</span><br><span class="line">ll sum[N &lt;&lt; <span class="number">2</span>], tag[N &lt;&lt; <span class="number">2</span>], a[N], at[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span> &#123;ll ver, Next;&#125; e[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(ll x, ll y)</span> </span>&#123;cnt++; e[cnt].Next = head[x]; head[x] = cnt; e[cnt].ver = y;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(ll o, ll l, ll r)</span> </span>&#123;</span><br><span class="line">	tag[<span class="built_in">ls</span>(o)] += tag[o]; tag[<span class="built_in">rs</span>(o)] += tag[o]; tag[<span class="built_in">ls</span>(o)] %= mod; tag[<span class="built_in">rs</span>(o)] %= mod; ll mid = (l + r) &gt;&gt; <span class="number">1</span>; </span><br><span class="line">	sum[<span class="built_in">ls</span>(o)] += (mid - l + <span class="number">1</span>) * tag[o] % mod; sum[<span class="built_in">ls</span>(o)] %= mod; sum[<span class="built_in">rs</span>(o)] += (r - mid) * tag[o] % mod; sum[<span class="built_in">rs</span>(o)] %= mod; tag[o] = <span class="number">0</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(ll o)</span> </span>&#123;sum[o] = (sum[<span class="built_in">ls</span>(o)] + sum[<span class="built_in">rs</span>(o)]) % mod;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(ll o, ll l, ll r)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (l == r) &#123;sum[o] = at[l] % mod; <span class="keyword">return</span>;&#125;</span><br><span class="line">	ll mid = (l + r) &gt;&gt; <span class="number">1</span>; <span class="built_in">build</span>(<span class="built_in">ls</span>(o), l, mid); <span class="built_in">build</span>(<span class="built_in">rs</span>(o), mid + <span class="number">1</span>, r); <span class="built_in">pushup</span>(o);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(ll o, ll l, ll r, ll L, ll R, ll val)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;sum[o] = (sum[o] + (r - l + <span class="number">1</span>) * val % mod) % mod; tag[o] = (tag[o] + val) % mod; <span class="keyword">return</span>;&#125;</span><br><span class="line">	ll mid = (l + r) &gt;&gt; <span class="number">1</span>; <span class="built_in">pushdown</span>(o, l, r); <span class="keyword">if</span> (mid &gt;= L) <span class="built_in">update</span>(<span class="built_in">ls</span>(o), l, mid, L, R, val); <span class="keyword">if</span> (mid + <span class="number">1</span> &lt;= R) <span class="built_in">update</span>(<span class="built_in">rs</span>(o), mid + <span class="number">1</span>, r, L, R, val); <span class="built_in">pushup</span>(o);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">query</span><span class="params">(ll o, ll l, ll r, ll L, ll R)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;<span class="keyword">return</span> sum[o];&#125;</span><br><span class="line">	ll mid = (l + r) &gt;&gt; <span class="number">1</span>, ret = <span class="number">0</span>; <span class="built_in">pushdown</span>(o, l, r); <span class="keyword">if</span> (mid &gt;= L) ret += <span class="built_in">query</span>(<span class="built_in">ls</span>(o), l, mid, L, R), ret %= mod; <span class="keyword">if</span> (mid + <span class="number">1</span> &lt;= R) ret += <span class="built_in">query</span>(<span class="built_in">rs</span>(o), mid + <span class="number">1</span>, r, L, R), ret %= mod; <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(ll x, ll from, ll nowdep)</span> </span>&#123;<span class="comment">//遍历 siz dep son</span></span><br><span class="line">	dep[x] = nowdep; fa[x] = from; siz[x] = <span class="number">1</span>; ll maxson = <span class="number">-1</span>;<span class="comment">//maxsiz</span></span><br><span class="line">	<span class="keyword">for</span> (ll i = head[x]; i; i = e[i].Next) &#123;</span><br><span class="line">		ll y = e[i].ver; <span class="keyword">if</span> (y == from) <span class="keyword">continue</span>; <span class="built_in">dfs1</span>(y, x, nowdep + <span class="number">1</span>);</span><br><span class="line">		siz[x] += siz[y]; <span class="keyword">if</span> (siz[y] &gt;= maxson) maxson = siz[y], son[x] = y;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(ll x, ll nowtop)</span> </span>&#123;<span class="comment">//先走maxson id(在新数组中下标) top 新数组的值 </span></span><br><span class="line">	id[x] = ++num; top[x] = nowtop; at[num] = a[x];</span><br><span class="line">	<span class="keyword">if</span> (!son[x]) <span class="keyword">return</span>; <span class="built_in">dfs2</span>(son[x], nowtop);</span><br><span class="line">	<span class="keyword">for</span> (ll i = head[x]; i; i = e[i].Next) &#123;</span><br><span class="line">		ll y = e[i].ver; <span class="keyword">if</span> (y == fa[x] || y == son[x]) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="built_in">dfs2</span>(y, y);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">updPath</span><span class="params">(ll x, ll y, ll val)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">while</span> (top[x] != top[y]) &#123;<span class="keyword">if</span> (dep[top[x]] &lt; dep[top[y]]) <span class="built_in">swap</span>(x, y);<span class="comment">/*保证top[x]的dep &gt;= top[y]的dep*/</span> <span class="built_in">update</span>(<span class="number">1</span>, <span class="number">1</span>, n, id[top[x]], id[x], val); x = fa[top[x]];<span class="comment">/* 需更新完一条链，要再往上跳一个，避免重复*/</span>&#125; </span><br><span class="line">	<span class="keyword">if</span> (dep[x] &gt; dep[y]) <span class="built_in">swap</span>(x, y);</span><br><span class="line">	<span class="built_in">update</span>(<span class="number">1</span>, <span class="number">1</span>, n, id[x], id[y], val);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">qPath</span><span class="params">(ll x, ll y)</span> </span>&#123;ll ret = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (top[x] != top[y]) &#123;<span class="keyword">if</span> (dep[top[x]] &lt; dep[top[y]]) <span class="built_in">swap</span>(x, y); ret = (ret + <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, n, id[top[x]], id[x])) % mod; x = fa[top[x]];&#125;</span><br><span class="line">	<span class="keyword">if</span> (dep[x] &gt; dep[y]) <span class="built_in">swap</span>(x, y);</span><br><span class="line">	ret = (ret + <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, n, id[x], id[y])) % mod; <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">updSon</span><span class="params">(ll x, ll val)</span> </span>&#123;<span class="built_in">update</span>(<span class="number">1</span>, <span class="number">1</span>, n, id[x], id[x] + siz[x] - <span class="number">1</span>, val);&#125;</span><br><span class="line"><span class="function">ll <span class="title">qSon</span><span class="params">(ll x)</span> </span>&#123;<span class="keyword">return</span> <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, n, id[x], id[x] + siz[x] - <span class="number">1</span>);&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	n = <span class="built_in">read</span>(); m = <span class="built_in">read</span>(); root = <span class="built_in">read</span>(); mod = <span class="built_in">read</span>(); <span class="built_in">For</span>(i, <span class="number">1</span>, n) a[i] = <span class="built_in">read</span>();</span><br><span class="line">	<span class="built_in">For</span>(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;ll x = <span class="built_in">read</span>(), y = <span class="built_in">read</span>(); <span class="built_in">insert</span>(x, y); <span class="built_in">insert</span>(y, x);&#125;</span><br><span class="line">	<span class="built_in">dfs1</span>(root, <span class="number">0</span>, <span class="number">1</span>); </span><br><span class="line">	<span class="built_in">dfs2</span>(root, root); </span><br><span class="line">	<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">	<span class="keyword">while</span> (m--) &#123;</span><br><span class="line">		ll opt = <span class="built_in">read</span>(), x, y, z;</span><br><span class="line">		<span class="keyword">if</span> (opt == <span class="number">1</span>) &#123;x = <span class="built_in">read</span>(), y = <span class="built_in">read</span>(), z = <span class="built_in">read</span>(); <span class="built_in">updPath</span>(x, y, z);&#125;</span><br><span class="line">		<span class="keyword">if</span> (opt == <span class="number">2</span>) &#123;x = <span class="built_in">read</span>(), y = <span class="built_in">read</span>(); <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">qPath</span>(x, y));&#125;</span><br><span class="line">		<span class="keyword">if</span> (opt == <span class="number">3</span>) &#123;x = <span class="built_in">read</span>(), z = <span class="built_in">read</span>(); <span class="built_in">updSon</span>(x, z);&#125;</span><br><span class="line">		<span class="keyword">if</span> (opt == <span class="number">4</span>) &#123;x = <span class="built_in">read</span>(); <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">qSon</span>(x));&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="线段树（带乘法）"><a href="#线段树（带乘法）" class="headerlink" title="线段树（带乘法）"></a>线段树（带乘法）</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//mul： </span></span><br><span class="line"><span class="comment">//add：</span></span><br><span class="line"><span class="comment">//add这一项将作为永存的常数，独立变化，直到被“裸露地”传下去 </span></span><br><span class="line"><span class="comment">//sum：即时改变 lazytag与当前节点的sum无关 </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> id)</span></span>&#123;</span><br><span class="line">	sum[id]=(sum[id&lt;&lt;<span class="number">1</span>]+sum[id&lt;&lt;<span class="number">1</span>|<span class="number">1</span>])%p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> id,<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;<span class="comment">//修改二子节点的sum，并传递lazytag </span></span><br><span class="line">	<span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	sum[id&lt;&lt;<span class="number">1</span>]=(sum[id&lt;&lt;<span class="number">1</span>]*mul[id]+add[id]*(mid-l<span class="number">+1</span>))%p;</span><br><span class="line">	sum[id&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]=(sum[id&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]*mul[id]+add[id]*(r-mid))%p;</span><br><span class="line">	</span><br><span class="line">	mul[id&lt;&lt;<span class="number">1</span>]=(mul[id&lt;&lt;<span class="number">1</span>]*mul[id])%p;</span><br><span class="line">	mul[id&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]=(mul[id&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]*mul[id])%p;</span><br><span class="line">	</span><br><span class="line">	add[id&lt;&lt;<span class="number">1</span>]=(add[id&lt;&lt;<span class="number">1</span>]*mul[id]+add[id])%p;</span><br><span class="line">	add[id&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]=(add[id&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]*mul[id]+add[id])%p;</span><br><span class="line">	</span><br><span class="line">	mul[id]=<span class="number">1</span>;</span><br><span class="line">	add[id]=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> id,<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	mul[id]=<span class="number">1</span>;</span><br><span class="line">	add[id]=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">		sum[id]=a[l]%p;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="built_in">build</span>(id&lt;&lt;<span class="number">1</span>,l,mid);</span><br><span class="line">	<span class="built_in">build</span>(id&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid<span class="number">+1</span>,r);</span><br><span class="line">	<span class="built_in">pushup</span>(id);</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="type">int</span> id,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(x&lt;=l&amp;&amp;r&lt;=y)&#123;</span><br><span class="line">		<span class="keyword">return</span> sum[id];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">pushdown</span>(id,l,r);</span><br><span class="line">	<span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	ll tot=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(x&lt;=mid) tot+=<span class="built_in">query</span>(id&lt;&lt;<span class="number">1</span>,l,mid,x,y);</span><br><span class="line">	<span class="keyword">if</span>(y&gt;mid) tot+=<span class="built_in">query</span>(id&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid<span class="number">+1</span>,r,x,y);</span><br><span class="line">	<span class="keyword">return</span> tot%p; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">update1</span><span class="params">(<span class="type">int</span> id,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> v)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(x&lt;=l&amp;&amp;r&lt;=y)&#123;</span><br><span class="line">		sum[id]=(sum[id]*v)%p;</span><br><span class="line">		mul[id]=(mul[id]*v)%p;</span><br><span class="line">		add[id]=(add[id]*v)%p;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="built_in">pushdown</span>(id,l,r);</span><br><span class="line">	<span class="keyword">if</span>(x&lt;=mid) <span class="built_in">update1</span>(id&lt;&lt;<span class="number">1</span>,l,mid,x,y,v);</span><br><span class="line">	<span class="keyword">if</span>(y&gt;mid) <span class="built_in">update1</span>(id&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid<span class="number">+1</span>,r,x,y,v);</span><br><span class="line">	<span class="built_in">pushup</span>(id);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">update2</span><span class="params">(<span class="type">int</span> id,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> v)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(x&lt;=l&amp;&amp;r&lt;=y)&#123;</span><br><span class="line">		add[id]=(add[id]+v)%p;</span><br><span class="line">		sum[id]=(sum[id]+v*(r-l<span class="number">+1</span>))%p;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="built_in">pushdown</span>(id,l,r);</span><br><span class="line">	<span class="keyword">if</span>(x&lt;=mid) <span class="built_in">update2</span>(id&lt;&lt;<span class="number">1</span>,l,mid,x,y,v);</span><br><span class="line">	<span class="keyword">if</span>(y&gt;mid) <span class="built_in">update2</span>(id&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid<span class="number">+1</span>,r,x,y,v);</span><br><span class="line">	<span class="built_in">pushup</span>(id);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin&gt;&gt;n&gt;&gt;m&gt;&gt;p;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) cin&gt;&gt;a[i];</span><br><span class="line">	<span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line">	<span class="keyword">while</span>(m--)&#123;</span><br><span class="line">		<span class="type">int</span> ch;</span><br><span class="line">		cin&gt;&gt;ch;</span><br><span class="line">		<span class="keyword">if</span>(ch==<span class="number">1</span>)&#123;</span><br><span class="line">			<span class="type">int</span> x,y,v;</span><br><span class="line">			cin&gt;&gt;x&gt;&gt;y&gt;&gt;v;</span><br><span class="line">			<span class="built_in">update1</span>(<span class="number">1</span>,<span class="number">1</span>,n,x,y,v);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(ch==<span class="number">2</span>)&#123;</span><br><span class="line">			<span class="type">int</span> x,y,v;</span><br><span class="line">			cin&gt;&gt;x&gt;&gt;y&gt;&gt;v;</span><br><span class="line">			<span class="built_in">update2</span>(<span class="number">1</span>,<span class="number">1</span>,n,x,y,v);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(ch==<span class="number">3</span>)&#123;</span><br><span class="line">			<span class="type">int</span> x,y;</span><br><span class="line">			cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line">			cout&lt;&lt;<span class="built_in">query</span>(<span class="number">1</span>,<span class="number">1</span>,n,x,y)&lt;&lt;endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="动态开点线段树"><a href="#动态开点线段树" class="headerlink" title="动态开点线段树"></a>动态开点线段树</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n,Q,a[N];</span><br><span class="line"><span class="type">int</span> rt,seg_idx;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">    <span class="type">int</span> l,r,ls,rs;</span><br><span class="line">    <span class="type">int</span> cnt,sum;</span><br><span class="line">&#125;tr[N&lt;&lt;<span class="number">3</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> o)</span></span>&#123;</span><br><span class="line">    tr[o].l=tr[tr[o].ls].l,tr[o].r=tr[tr[o].rs].r;</span><br><span class="line">    tr[o].cnt=tr[tr[o].ls].cnt+tr[tr[o].rs].cnt;</span><br><span class="line">    tr[o].sum=tr[tr[o].ls].sum+tr[tr[o].rs].sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">int</span>&amp; o,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x,<span class="type">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!o)&#123;<span class="comment">//动态开点 1-n区间为1</span></span><br><span class="line">        o=++seg_idx;</span><br><span class="line">        tr[o].l=l,tr[o].r=r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        tr[o].cnt+=v;</span><br><span class="line">        tr[o].sum+=v*x;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">modify</span>(tr[o].ls,l,mid,x,v);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">modify</span>(tr[o].rs,mid<span class="number">+1</span>,r,x,v);</span><br><span class="line">    <span class="built_in">pushup</span>(o);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//反向从大到小从sum中除去</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> o,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> sum)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        <span class="keyword">if</span>(sum&lt;=<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">ceil</span>((<span class="type">long</span> <span class="type">double</span>)sum/l);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(tr[tr[o].rs].sum&gt;=sum) <span class="keyword">return</span> <span class="built_in">query</span>(tr[o].rs,mid<span class="number">+1</span>,r,sum);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">query</span>(tr[o].ls,l,mid,sum-tr[tr[o].rs].sum)+tr[tr[o].rs].cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> sum=<span class="number">0</span>;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;Q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        cin&gt;&gt;a[i];</span><br><span class="line">        <span class="keyword">if</span>(a[i]&gt;<span class="number">0</span>) <span class="built_in">modify</span>(rt,<span class="number">1</span>,INF,a[i],<span class="number">1</span>);</span><br><span class="line">        sum+=a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(Q--)&#123;</span><br><span class="line">        <span class="type">int</span> x,v;</span><br><span class="line">        cin&gt;&gt;x&gt;&gt;v;</span><br><span class="line">        <span class="keyword">if</span>(a[x]&gt;<span class="number">0</span>) <span class="built_in">modify</span>(rt,<span class="number">1</span>,INF,a[x],<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">if</span>(v&gt;<span class="number">0</span>) <span class="built_in">modify</span>(rt,<span class="number">1</span>,INF,v,<span class="number">1</span>);</span><br><span class="line">        sum-=a[x];sum+=v;</span><br><span class="line">        a[x]=v;</span><br><span class="line">        cout&lt;&lt;tr[<span class="number">1</span>].cnt-<span class="built_in">query</span>(rt,<span class="number">1</span>,INF,sum)<span class="number">+1</span>&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>)-&gt;<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">solve</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="线性筛"><a href="#线性筛" class="headerlink" title="线性筛"></a>线性筛</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> N 100000005 </span></span><br><span class="line"><span class="type">bool</span> isprime[N];</span><br><span class="line">ll prime[N], cnt, n, q;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">work</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(isprime, <span class="number">1</span>, <span class="built_in">sizeof</span>(isprime));</span><br><span class="line">	isprime[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">For</span>(i, <span class="number">2</span>, n) &#123;</span><br><span class="line">		<span class="keyword">if</span> (isprime[i]) prime[++cnt] = i;</span><br><span class="line">		<span class="keyword">for</span> (ll j = <span class="number">1</span>; j &lt;= cnt &amp;&amp; i * prime[j] &lt;= n; j++) &#123;</span><br><span class="line">			isprime[i * prime[j]] = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">if</span> (i % prime[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	n = <span class="built_in">read</span>(); q = <span class="built_in">read</span>();</span><br><span class="line">	<span class="built_in">work</span>();</span><br><span class="line">	<span class="keyword">while</span> (q--) &#123;<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, prime[<span class="built_in">read</span>()]);&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h2 id="LCA"><a href="#LCA" class="headerlink" title="LCA"></a>LCA</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> head[N],cnt,dep[N],f[N][<span class="number">25</span>],n,m,s;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span>&#123;</span><br><span class="line">	<span class="type">int</span> ver,Next;</span><br><span class="line">&#125;e[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	e[++cnt].Next=head[x];head[x]=cnt;e[cnt].ver=y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> from)</span></span>&#123;</span><br><span class="line">	dep[x]=dep[from]<span class="number">+1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;(<span class="number">1</span>&lt;&lt;i)&lt;=dep[x];i++)</span><br><span class="line">		f[x][i<span class="number">+1</span>]=f[f[x][i]][i];</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=e[i].Next)&#123;</span><br><span class="line">		<span class="type">int</span> y=e[i].ver; </span><br><span class="line">		<span class="keyword">if</span>(y==from) <span class="keyword">continue</span>;</span><br><span class="line">		f[y][<span class="number">0</span>]=x;</span><br><span class="line">		<span class="built_in">dfs</span>(y,x);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">LCA</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(dep[x]&lt;dep[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">20</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">		<span class="keyword">if</span>(dep[f[x][i]]&gt;=dep[y]) x=f[x][i];</span><br><span class="line">		<span class="keyword">if</span>(x==y) <span class="keyword">return</span> x;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">20</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">		<span class="keyword">if</span>(f[x][i]!=f[y][i])<span class="comment">//向上同步跳到fa相同时 </span></span><br><span class="line">			x=f[x][i],y=f[y][i];</span><br><span class="line">	<span class="keyword">return</span> f[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin&gt;&gt;n&gt;&gt;m&gt;&gt;s;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n<span class="number">-1</span>;i++)&#123;</span><br><span class="line">		<span class="type">int</span> x,y;</span><br><span class="line">		cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line">		<span class="built_in">insert</span>(x,y); <span class="built_in">insert</span>(y,x);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">dfs</span>(s,<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">while</span>(m--)&#123;</span><br><span class="line">		<span class="type">int</span> x,y;</span><br><span class="line">		cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line">		cout&lt;&lt;<span class="built_in">LCA</span>(x,y)&lt;&lt;endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h2 id="LCT"><a href="#LCT" class="headerlink" title="LCT"></a>LCT</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	<span class="type">int</span> s[<span class="number">2</span>],p,v;</span><br><span class="line">	<span class="type">int</span> sum,rev;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="type">int</span> stk[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	t[x].sum=t[t[x].s[<span class="number">0</span>]].sum^t[t[x].s[<span class="number">1</span>]].sum^t[x].v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(t[x].rev)&#123;</span><br><span class="line">		<span class="built_in">swap</span>(t[x].s[<span class="number">0</span>],t[x].s[<span class="number">1</span>]);</span><br><span class="line">		t[t[x].s[<span class="number">0</span>]].rev^=<span class="number">1</span>,t[t[x].s[<span class="number">1</span>]].rev^=<span class="number">1</span>;</span><br><span class="line">		t[x].rev=<span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isroot</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> t[t[x].p].s[<span class="number">0</span>]!=x&amp;&amp;t[t[x].p].s[<span class="number">1</span>]!=x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> y=t[x].p,z=t[y].p;</span><br><span class="line">	<span class="type">int</span> k=t[y].s[<span class="number">1</span>]==x;</span><br><span class="line">	<span class="keyword">if</span>(!<span class="built_in">isroot</span>(y)) t[z].s[t[z].s[<span class="number">1</span>]==y]=x;</span><br><span class="line">	<span class="comment">//若y是根节点，则y与z之间是一条轻边，是连接两个不同splay的边</span></span><br><span class="line">	<span class="comment">//z不能认x作儿子</span></span><br><span class="line">	t[x].p=z;</span><br><span class="line">	t[y].s[k]=t[x].s[k^<span class="number">1</span>],t[t[x].s[k^<span class="number">1</span>]].p=y;</span><br><span class="line">	t[x].s[k^<span class="number">1</span>]=y,t[y].p=x;</span><br><span class="line">	<span class="built_in">pushup</span>(y),<span class="built_in">pushup</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> top=<span class="number">0</span>,r=x;</span><br><span class="line">	stk[++top]=r;</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isroot</span>(r)) stk[++top]=t[r].p,r=t[r].p;</span><br><span class="line">	<span class="keyword">while</span>(top) <span class="built_in">pushdown</span>(stk[top--]);</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isroot</span>(x))&#123;</span><br><span class="line">		<span class="type">int</span> y=t[x].p,z=t[y].p;</span><br><span class="line">		<span class="keyword">if</span>(!<span class="built_in">isroot</span>(y))&#123;</span><br><span class="line">			<span class="keyword">if</span>((t[y].s[<span class="number">1</span>]==x)^(t[z].s[<span class="number">1</span>]==y)) <span class="built_in">rotate</span>(x);</span><br><span class="line">			<span class="keyword">else</span> <span class="built_in">rotate</span>(y);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">rotate</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">access</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="comment">//打通x向根节点的路径，将x变成原树的根节点 </span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> y=<span class="number">0</span>;x;y=x,x=t[x].p)&#123;</span><br><span class="line">		<span class="built_in">splay</span>(x);</span><br><span class="line">		t[x].s[<span class="number">1</span>]=y,<span class="built_in">pushup</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">makeroot</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="comment">//将x设为根节点 </span></span><br><span class="line">	<span class="built_in">access</span>(x);</span><br><span class="line">	<span class="built_in">splay</span>(x);</span><br><span class="line">	t[x].rev^=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">findroot</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="comment">//找到x所在原树的根节点，再将原树的根节点旋转到splay的根节点 </span></span><br><span class="line">	<span class="built_in">access</span>(x);</span><br><span class="line">	<span class="built_in">splay</span>(x);</span><br><span class="line">	<span class="keyword">while</span>(t[x].s[<span class="number">0</span>]) <span class="built_in">pushdown</span>(x),x=t[x].s[<span class="number">0</span>];</span><br><span class="line">	<span class="built_in">splay</span>(x);</span><br><span class="line">	<span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="comment">//给x和y之间的路径建立一个splay，其根节点是y </span></span><br><span class="line">	<span class="built_in">makeroot</span>(x);</span><br><span class="line">	<span class="built_in">access</span>(y);</span><br><span class="line">	<span class="built_in">splay</span>(y);</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">link</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="comment">//如果x和y不连通，则加入一条x和y之间的边 </span></span><br><span class="line">	<span class="built_in">makeroot</span>(x);</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">findroot</span>(y)!=x) t[x].p=y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">cut</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="comment">//如果x和y之间存在边，则删除该边 </span></span><br><span class="line">	<span class="built_in">makeroot</span>(x);</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">findroot</span>(y)==x&amp;&amp;t[y].p==x&amp;&amp;!t[y].s[<span class="number">0</span>])&#123;</span><br><span class="line">		t[x].s[<span class="number">1</span>]=t[y].p=<span class="number">0</span>;</span><br><span class="line">		<span class="built_in">pushup</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) cin&gt;&gt;t[i].v;</span><br><span class="line">	<span class="keyword">while</span>(m--)&#123;</span><br><span class="line">		<span class="type">int</span> op,x,y;</span><br><span class="line">		cin&gt;&gt;op&gt;&gt;x&gt;&gt;y;</span><br><span class="line">		<span class="keyword">if</span>(op==<span class="number">0</span>)&#123;</span><br><span class="line">			<span class="built_in">split</span>(x,y);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,t[y].sum);</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">1</span>) <span class="built_in">link</span>(x,y);</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">2</span>) <span class="built_in">cut</span>(x,y);</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="built_in">splay</span>(x);</span><br><span class="line">			t[x].v=y;</span><br><span class="line">			<span class="built_in">pushup</span>(x);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h2 id="int128"><a href="#int128" class="headerlink" title="int128"></a>int128</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> __int128 <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    __int128 x=<span class="number">0</span>,f=<span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(ch==<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">            f=<span class="number">-1</span>;</span><br><span class="line">        ch=<span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>)&#123;</span><br><span class="line">        x=x*<span class="number">10</span>+ch-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        ch=<span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">print</span><span class="params">(__int128 x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">        x=-x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(x&gt;<span class="number">9</span>)</span><br><span class="line">        <span class="built_in">print</span>(x/<span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(x%<span class="number">10</span>+<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    __int128 a = <span class="built_in">read</span>();</span><br><span class="line">    __int128 b = <span class="built_in">read</span>();</span><br><span class="line">    <span class="built_in">print</span>(a + b);</span><br><span class="line">    cout&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="双哈希"><a href="#双哈希" class="headerlink" title="双哈希"></a>双哈希</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ull base=<span class="number">131</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	ull x,y;</span><br><span class="line">&#125;a[N];</span><br><span class="line"><span class="type">char</span> s[N];</span><br><span class="line">ull ans=<span class="number">1</span>,n;</span><br><span class="line">ull mod1=<span class="number">19260817</span>;</span><br><span class="line">ull mod2=<span class="number">19660813</span>;</span><br><span class="line"><span class="function">ull <span class="title">hash1</span><span class="params">(<span class="type">char</span> s[])</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> len=<span class="built_in">strlen</span>(s);</span><br><span class="line">	ull ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">		ans=(ans*base+(ull)s[i])%mod1;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ull <span class="title">hash2</span><span class="params">(<span class="type">char</span> s[])</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> len=<span class="built_in">strlen</span>(s);</span><br><span class="line">	ull ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">		ans=(ans*base+(ull)s[i])%mod2;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(node a,node b)</span></span>&#123;<span class="comment">//必须这么写！否则会WA和死循环 </span></span><br><span class="line">	<span class="keyword">return</span> a.x &lt; b.x;</span><br><span class="line">	<span class="keyword">return</span> a.y &lt; b.y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		cin&gt;&gt;s;</span><br><span class="line">		a[i].x=<span class="built_in">hash1</span>(s);</span><br><span class="line">		a[i].y=<span class="built_in">hash2</span>(s);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">sort</span>(a<span class="number">+1</span>,a+n<span class="number">+1</span>,cmp);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">		<span class="keyword">if</span>(a[i].x!=a[i<span class="number">-1</span>].x||a[i].y!=a[i<span class="number">-1</span>].y)</span><br><span class="line">			ans++;</span><br><span class="line">	cout&lt;&lt;ans;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">ll fail[N],la,lb;</span><br><span class="line"><span class="type">char</span> a[N],b[N];</span><br><span class="line">string s1,s2;</span><br><span class="line"><span class="comment">//KMP本质：前后缀全等  </span></span><br><span class="line"><span class="comment">//i控制后缀，j控制前缀 </span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin&gt;&gt;s1;cin&gt;&gt;s2;la=s<span class="number">1.l</span>ength();lb=s<span class="number">2.l</span>ength();</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=la;i++)</span><br><span class="line">		a[i]=s1[i<span class="number">-1</span>];</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=lb;i++)</span><br><span class="line">		b[i]=s2[i<span class="number">-1</span>];</span><br><span class="line">	fail[<span class="number">1</span>]=<span class="number">0</span>;<span class="comment">//fail[1]=0 1的上一个是空</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>,j=<span class="number">0</span>;i&lt;=lb;i++)&#123;<span class="comment">//从2开始，1已经预处理过了 </span></span><br><span class="line">		<span class="keyword">while</span>(j&gt;<span class="number">0</span>&amp;&amp;b[j<span class="number">+1</span>]!=b[i]) j=fail[j];<span class="comment">//匹上一部分但中断了 </span></span><br><span class="line">		<span class="keyword">if</span>(b[j<span class="number">+1</span>]==b[i]) j++;</span><br><span class="line">		fail[i]=j;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,j=<span class="number">0</span>;i&lt;=la;i++)&#123;<span class="comment">//从1开始 </span></span><br><span class="line">		<span class="keyword">while</span>(j&gt;<span class="number">0</span>&amp;&amp;b[j<span class="number">+1</span>]!=a[i]) j=fail[j];</span><br><span class="line">		<span class="keyword">if</span>(b[j<span class="number">+1</span>]==a[i]) j++;</span><br><span class="line">		<span class="keyword">if</span>(j==lb) cout&lt;&lt;i-lb<span class="number">+1</span>&lt;&lt;endl,j=fail[j];<span class="comment">//j变成fail[j]，继续匹配，保证不重叠且遍历 </span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=lb;i++) cout&lt;&lt;fail[i]&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="AC自动机1"><a href="#AC自动机1" class="headerlink" title="AC自动机1"></a>AC自动机1</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Trie</span>&#123;</span><br><span class="line">	<span class="type">int</span> fail,vis[<span class="number">35</span>],end;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="type">int</span> cnt=<span class="number">0</span>,n;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ac_insert</span><span class="params">(string s)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> len=s.<span class="built_in">length</span>(),now=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(t[now].vis[s[i]-<span class="string">&#x27;a&#x27;</span>]==<span class="number">0</span>)</span><br><span class="line">			t[now].vis[s[i]-<span class="string">&#x27;a&#x27;</span>]=++cnt;</span><br><span class="line">		now=t[now].vis[s[i]-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	t[now].end++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_fail</span><span class="params">()</span></span>&#123;</span><br><span class="line">	queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">25</span>;i++)</span><br><span class="line">		<span class="keyword">if</span>(t[<span class="number">0</span>].vis[i])&#123;</span><br><span class="line">			t[t[<span class="number">0</span>].vis[i]].fail=<span class="number">0</span>;</span><br><span class="line">			q.<span class="built_in">push</span>(t[<span class="number">0</span>].vis[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">		<span class="type">int</span> x=q.<span class="built_in">front</span>();q.<span class="built_in">pop</span>();</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">25</span>;i++)&#123;<span class="comment">//每个节点往26个方向拓展 </span></span><br><span class="line">			<span class="keyword">if</span>(t[x].vis[i])&#123;</span><br><span class="line">				t[t[x].vis[i]].fail=t[t[x].fail].vis[i];</span><br><span class="line">				 <span class="comment">//子节点的fail指针指向当前节点的</span></span><br><span class="line">						 <span class="comment">//fail指针所指向节点的相同子节点 </span></span><br><span class="line">				q.<span class="built_in">push</span>(t[x].vis[i]);</span><br><span class="line">			&#125;<span class="keyword">else</span> t[x].vis[i]=t[t[x].fail].vis[i];</span><br><span class="line">			<span class="comment">//当前节点的这个子节点指向</span></span><br><span class="line">			<span class="comment">//当前节点fail指针的这个子节点 </span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ac_query</span><span class="params">(string s)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> len=s.<span class="built_in">length</span>(),now=<span class="number">0</span>,ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">		now=t[now].vis[s[i]-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> u=now;u&amp;&amp;t[u].end!=<span class="number">-1</span>;u=t[u].fail)&#123;</span><br><span class="line">			ans+=t[u].end;</span><br><span class="line">			t[u].end=<span class="number">-1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		string s;cin&gt;&gt;s;<span class="built_in">ac_insert</span>(s);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">get_fail</span>();</span><br><span class="line">	string s;cin&gt;&gt;s;<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="built_in">ac_query</span>(s));</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="AC自动机2"><a href="#AC自动机2" class="headerlink" title="AC自动机2"></a>AC自动机2</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Trie</span>&#123;</span><br><span class="line">	<span class="type">int</span> fail,vis[<span class="number">35</span>];</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="type">int</span> cnt=<span class="number">0</span>,n,num[N],ans[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ac_insert</span><span class="params">(string s,<span class="type">int</span> v)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> len=s.<span class="built_in">length</span>(),now=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(t[now].vis[s[i]-<span class="string">&#x27;a&#x27;</span>]==<span class="number">0</span>)</span><br><span class="line">			t[now].vis[s[i]-<span class="string">&#x27;a&#x27;</span>]=++cnt;</span><br><span class="line">		now=t[now].vis[s[i]-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	num[now]=v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_fail</span><span class="params">()</span></span>&#123;</span><br><span class="line">	queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">25</span>;i++)</span><br><span class="line">		<span class="keyword">if</span>(t[<span class="number">0</span>].vis[i])&#123;</span><br><span class="line">			t[t[<span class="number">0</span>].vis[i]].fail=<span class="number">0</span>;</span><br><span class="line">			q.<span class="built_in">push</span>(t[<span class="number">0</span>].vis[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">		<span class="type">int</span> x=q.<span class="built_in">front</span>();q.<span class="built_in">pop</span>();</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">25</span>;i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(t[x].vis[i])&#123;</span><br><span class="line">				t[t[x].vis[i]].fail=t[t[x].fail].vis[i];</span><br><span class="line">				 <span class="comment">//子节点的fail指针指向当前节点的</span></span><br><span class="line">						 <span class="comment">//fail指针所指向节点的相同子节点 </span></span><br><span class="line">				q.<span class="built_in">push</span>(t[x].vis[i]);</span><br><span class="line">			&#125;<span class="keyword">else</span> t[x].vis[i]=t[t[x].fail].vis[i];</span><br><span class="line">			<span class="comment">//当前节点的这个子节点指向</span></span><br><span class="line">			<span class="comment">//当前节点fail指针的这个子节点 </span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(string s)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> len=s.<span class="built_in">length</span>(),now=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">		now=t[now].vis[s[i]-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> u=now;u;u=t[u].fail)&#123;</span><br><span class="line">			ans[num[u]]++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">string s[N],str;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(cin&gt;&gt;n&amp;&amp;n)&#123;</span><br><span class="line">		<span class="built_in">memset</span>(num,<span class="number">0</span>,<span class="built_in">sizeof</span>(num));</span><br><span class="line">		<span class="built_in">memset</span>(ans,<span class="number">0</span>,<span class="built_in">sizeof</span>(ans));</span><br><span class="line">		<span class="built_in">memset</span>(t,<span class="number">0</span>,<span class="built_in">sizeof</span>(t));</span><br><span class="line">		cnt=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">			cin&gt;&gt;s[i];</span><br><span class="line">			<span class="built_in">ac_insert</span>(s[i],i);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">get_fail</span>();</span><br><span class="line">		cin&gt;&gt;str;</span><br><span class="line">		<span class="built_in">query</span>(str);</span><br><span class="line">		<span class="type">int</span> maxn=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) <span class="keyword">if</span>(ans[i]&gt;maxn) maxn=ans[i];</span><br><span class="line">		cout&lt;&lt;maxn&lt;&lt;endl;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) <span class="keyword">if</span>(ans[i]==maxn) cout&lt;&lt;s[i]&lt;&lt;endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="AC自动机3"><a href="#AC自动机3" class="headerlink" title="AC自动机3"></a>AC自动机3</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Trie</span>&#123;</span><br><span class="line">	<span class="type">int</span> fail,vis[<span class="number">35</span>];</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="type">int</span> cnt=<span class="number">0</span>,n,num[N],ans[N],hd[N],ne[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ac_insert</span><span class="params">(string s,<span class="type">int</span> v)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> len=s.<span class="built_in">length</span>(),now=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(t[now].vis[s[i]-<span class="string">&#x27;a&#x27;</span>]==<span class="number">0</span>)</span><br><span class="line">			t[now].vis[s[i]-<span class="string">&#x27;a&#x27;</span>]=++cnt;</span><br><span class="line">		now=t[now].vis[s[i]-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	ne[v]=hd[now],hd[now]=v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> q[N],head,tail;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_fail</span><span class="params">()</span></span>&#123;</span><br><span class="line">	head=<span class="number">1</span>,tail=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">25</span>;i++)</span><br><span class="line">		<span class="keyword">if</span>(t[<span class="number">0</span>].vis[i])&#123;</span><br><span class="line">			t[t[<span class="number">0</span>].vis[i]].fail=<span class="number">0</span>;</span><br><span class="line">			q[++tail]=t[<span class="number">0</span>].vis[i];</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">while</span>(head&lt;=tail)&#123;</span><br><span class="line">		<span class="type">int</span> x=q[head++];</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">25</span>;i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(t[x].vis[i])&#123;</span><br><span class="line">				t[t[x].vis[i]].fail=t[t[x].fail].vis[i];</span><br><span class="line">				q[++tail]=t[x].vis[i];</span><br><span class="line">			&#125;<span class="keyword">else</span> t[x].vis[i]=t[t[x].fail].vis[i];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> d[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">query</span><span class="params">(string s)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> now=<span class="number">0</span>,len=s.<span class="built_in">length</span>();</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++) &#123;</span><br><span class="line">		now=t[now].vis[s[i]-<span class="string">&#x27;a&#x27;</span>];d[now]++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//本来需要从每个点向根节点一直跳fail指针并+1</span></span><br><span class="line">	<span class="comment">//现在用拓扑序减小了时间复杂度</span></span><br><span class="line">	<span class="comment">//按照拓扑逆序向上递推即可 </span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=cnt;i&gt;=<span class="number">1</span>;i--)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j=hd[q[i]];j;j=ne[j]) ans[j]=d[q[i]];</span><br><span class="line">		d[t[q[i]].fail]+=d[q[i]];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">string s[N],str;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		cin&gt;&gt;s[i];</span><br><span class="line">		<span class="built_in">ac_insert</span>(s[i],i);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">get_fail</span>();</span><br><span class="line">	cin&gt;&gt;str;</span><br><span class="line">	<span class="built_in">query</span>(str);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) cout&lt;&lt;ans[i]&lt;&lt;endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Manacher"><a href="#Manacher" class="headerlink" title="Manacher"></a>Manacher</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n,len,hw[N];</span><br><span class="line"><span class="comment">//hw[i]:第i位置的回文半径（包括i自己）</span></span><br><span class="line"><span class="type">char</span> str[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pre</span><span class="params">()</span></span>&#123;<span class="comment">//处理后，只判断奇回文串即可</span></span><br><span class="line">    n=<span class="number">1</span>;</span><br><span class="line">    s[<span class="number">0</span>]=<span class="string">&#x27;&lt;&#x27;</span>;<span class="comment">//防止数组在0处越界</span></span><br><span class="line">    s[<span class="number">1</span>]=<span class="string">&#x27;|&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">        s[++n]=str[i],s[++n]=<span class="string">&#x27;|&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">manacher</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> mid=<span class="number">1</span>,maxr=<span class="number">1</span>,ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i&lt;=maxr)</span><br><span class="line">            hw[i]=<span class="built_in">min</span>(hw[mid*<span class="number">2</span>-i],maxr-i<span class="number">+1</span>);<span class="comment">//在不超过maxr的条件下继承对称点的hw</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            hw[i]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(s[i-hw[i]]==s[i+hw[i]])</span><br><span class="line">            hw[i]++;</span><br><span class="line">        <span class="keyword">if</span>(i+hw[i]<span class="number">-1</span>&gt;maxr)&#123;</span><br><span class="line">            mid=i;</span><br><span class="line">            maxr=i+hw[i]<span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ans=<span class="built_in">max</span>(ans,hw[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;ans<span class="number">-1</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="启发式合并（各种）"><a href="#启发式合并（各种）" class="headerlink" title="启发式合并（各种）"></a>启发式合并（各种）</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//链表</span></span><br><span class="line"><span class="type">int</span> ans[N],sz[N],tmp[N],fst[N],nxt[N],f[N],s,n,m,a[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> &amp;x,<span class="type">int</span> &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(sz[x]&gt;sz[y]) <span class="built_in">swap</span>(x,y);<span class="comment">//x小y大</span></span><br><span class="line">    <span class="keyword">if</span>(!sz[x]||x==y) <span class="keyword">return</span>;<span class="comment">//特判</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=fst[x];i!=<span class="number">-1</span>;i=nxt[i])</span><br><span class="line">        s-=(a[i<span class="number">-1</span>]==y)+(a[i<span class="number">+1</span>]==y);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=fst[x];i!=<span class="number">-1</span>;i=nxt[i])&#123;</span><br><span class="line">        a[i]=y;</span><br><span class="line">        <span class="keyword">if</span>(nxt[i]==<span class="number">-1</span>)&#123;</span><br><span class="line">            nxt[i]=fst[y];</span><br><span class="line">            fst[y]=fst[x];</span><br><span class="line">            fst[x]=<span class="number">-1</span>;</span><br><span class="line">            sz[y]+=sz[x];</span><br><span class="line">            sz[x]=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;<span class="comment">//一定要有，否则进-1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;N;i++) fst[i]=<span class="number">-1</span>,f[i]=i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        cin&gt;&gt;a[i];</span><br><span class="line">        nxt[i]=fst[a[i]];fst[a[i]]=i;sz[a[i]]++;</span><br><span class="line">        <span class="comment">//加入该颜色对应的链表</span></span><br><span class="line">        <span class="comment">//id为i(实际位置)</span></span><br><span class="line">        <span class="keyword">if</span>(nxt[i]!=i<span class="number">-1</span>) s++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">        <span class="type">int</span> opt,x,y;</span><br><span class="line">        cin&gt;&gt;opt;</span><br><span class="line">        <span class="keyword">if</span>(opt==<span class="number">2</span>) cout&lt;&lt;s&lt;&lt;<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span> cin&gt;&gt;x&gt;&gt;y,<span class="built_in">merge</span>(f[x],f[y]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="二维凸包"><a href="#二维凸包" class="headerlink" title="二维凸包"></a>二维凸包</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">double</span> EPS=<span class="number">1e-8</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span><span class="number">+5</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">    <span class="type">double</span> x,y;</span><br><span class="line">&#125;p[N],s[N];</span><br><span class="line"><span class="type">int</span> n,top;</span><br><span class="line"><span class="type">double</span> ans;</span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">Power</span><span class="params">(<span class="type">double</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x*x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">Dis</span><span class="params">(node a,node b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sqrt</span>(<span class="built_in">Power</span>(a.x-b.x)+<span class="built_in">Power</span>(a.y-b.y));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">Cross</span><span class="params">(node a,node b,node c,node d)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (b.x-a.x)*(d.y-c.y)-(d.x-c.x)*(b.y-a.y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(node a,node b)</span></span>&#123;</span><br><span class="line">    <span class="type">double</span> tmp=<span class="built_in">Cross</span>(p[<span class="number">1</span>],a,p[<span class="number">1</span>],b);</span><br><span class="line">    <span class="keyword">if</span>(tmp&gt;<span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(tmp==<span class="number">0</span>&amp;&amp;<span class="built_in">Dis</span>(p[<span class="number">1</span>],a)&lt;<span class="built_in">Dis</span>(p[<span class="number">1</span>],b)) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        cin&gt;&gt;p[i].x&gt;&gt;p[i].y;</span><br><span class="line">        <span class="keyword">if</span>(p[i].y&lt;p[<span class="number">1</span>].y||(p[i].y==p[<span class="number">1</span>].y&amp;&amp;p[i].x&lt;p[<span class="number">1</span>].x))</span><br><span class="line">            <span class="built_in">swap</span>(p[<span class="number">1</span>],p[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(p<span class="number">+2</span>,p+n<span class="number">+1</span>,cmp);</span><br><span class="line">    s[<span class="number">1</span>]=p[<span class="number">1</span>];</span><br><span class="line">    top=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="keyword">while</span>(top&gt;<span class="number">1</span>&amp;&amp;<span class="built_in">Cross</span>(s[top<span class="number">-1</span>],s[top],s[top],p[i])&lt;=EPS) top--;</span><br><span class="line">        s[++top]=p[i];</span><br><span class="line">    &#125;</span><br><span class="line">    s[top<span class="number">+1</span>]=p[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=top;i++)</span><br><span class="line">        ans+=<span class="built_in">Dis</span>(s[i],s[i<span class="number">+1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.2lf\n&quot;</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="旋转卡壳"><a href="#旋转卡壳" class="headerlink" title="旋转卡壳"></a>旋转卡壳</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">5e4</span><span class="number">+5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> EPS=<span class="number">1e-12</span>;</span><br><span class="line"><span class="type">int</span> n,tot,ans;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Vector</span>&#123;</span><br><span class="line">	<span class="type">double</span> x,y;</span><br><span class="line">	<span class="built_in">Vector</span>(<span class="type">double</span> a=<span class="number">0</span>,<span class="type">double</span> b=<span class="number">0</span>)&#123;x=a,y=b;&#125;</span><br><span class="line">	Vector <span class="keyword">operator</span>+(Vector a)&#123;<span class="keyword">return</span> <span class="built_in">Vector</span>(x+a.x,y+a.y);&#125;</span><br><span class="line">	Vector <span class="keyword">operator</span>-(Vector a)&#123;<span class="keyword">return</span> <span class="built_in">Vector</span>(x-a.x,y-a.y);&#125;</span><br><span class="line">	Vector <span class="keyword">operator</span>*(<span class="type">double</span> a)&#123;<span class="keyword">return</span> <span class="built_in">Vector</span>(x*a,y*a);&#125;</span><br><span class="line">	Vector <span class="keyword">operator</span>/(<span class="type">double</span> a)&#123;<span class="keyword">return</span> <span class="built_in">Vector</span>(x/a,y/a);&#125;</span><br><span class="line">	<span class="function"><span class="type">double</span> <span class="title">len</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="built_in">sqrt</span>(x*x+y*y);&#125;</span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">len2</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> x*x+y*y;&#125;</span><br><span class="line">	<span class="function"><span class="type">double</span> <span class="title">dis</span><span class="params">(Vector a)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Vector</span>(a-(*<span class="keyword">this</span>)).<span class="built_in">len</span>();&#125;</span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">dis2</span><span class="params">(Vector a)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Vector</span>(a-(*<span class="keyword">this</span>)).<span class="built_in">len2</span>();&#125;</span><br><span class="line">	<span class="function"><span class="type">double</span> <span class="title">dot</span><span class="params">(Vector a)</span></span>&#123;<span class="keyword">return</span> x*a.x+y*a.y;&#125;</span><br><span class="line">	<span class="function"><span class="type">double</span> <span class="title">cross</span><span class="params">(Vector a)</span></span>&#123;<span class="keyword">return</span> x*a.y-y*a.x;&#125;</span><br><span class="line">	<span class="type">bool</span> <span class="keyword">operator</span>&lt;(Vector a)<span class="type">const</span>&#123;<span class="keyword">return</span> (x&lt;a.x)||(x==a.x&amp;&amp;y&lt;a.y);&#125;</span><br><span class="line">&#125;s[N],t[N];</span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">Dis</span><span class="params">(Vector p,Vector a,Vector b)</span></span>&#123;</span><br><span class="line">    Vector v1=p-a,v2=b-a;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fabs</span>(v<span class="number">1.</span><span class="built_in">cross</span>(v2)/v<span class="number">2.l</span>en());</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//此模板输出的是答案的平方</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) cin&gt;&gt;s[i].x&gt;&gt;s[i].y;</span><br><span class="line">	<span class="built_in">sort</span>(s<span class="number">+1</span>,s+n<span class="number">+1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="keyword">while</span>(tot&gt;<span class="number">1</span>&amp;&amp;(t[tot]-t[tot<span class="number">-1</span>]).<span class="built_in">cross</span>(s[i]-t[tot])&lt;EPS) tot--;</span><br><span class="line">        <span class="comment">//第一次逆时针，cross为正</span></span><br><span class="line">        t[++tot]=s[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> ntot=tot;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-1</span>;i&gt;=<span class="number">1</span>;i--)&#123;<span class="comment">//正着来一遍，反着来一遍，形成一个覆盖全部情况的序列</span></span><br><span class="line">        <span class="keyword">while</span>(tot&gt;ntot&amp;&amp;(t[tot]-t[tot<span class="number">-1</span>]).<span class="built_in">cross</span>(s[i]-t[tot])&lt;EPS) tot--;</span><br><span class="line">        <span class="comment">//第二次顺时针，手玩知如何判断合法性</span></span><br><span class="line">        t[++tot]=s[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(tot==<span class="number">3</span>)&#123;<span class="comment">//不加会T掉？？？</span></span><br><span class="line">        cout&lt;&lt;t[<span class="number">1</span>].<span class="built_in">dis2</span>(t[<span class="number">2</span>])&lt;&lt;<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> now=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=tot;i++)&#123;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">Dis</span>(t[now],t[i<span class="number">-1</span>],t[i])-<span class="built_in">Dis</span>(t[now%tot<span class="number">+1</span>],t[i<span class="number">-1</span>],t[i])&lt;EPS)<span class="comment">//0-&gt;EPS</span></span><br><span class="line">            now=now%tot<span class="number">+1</span>;</span><br><span class="line">        ans=<span class="built_in">max</span>(ans,<span class="built_in">max</span>(t[now].<span class="built_in">dis2</span>(t[i<span class="number">-1</span>]),t[now].<span class="built_in">dis2</span>(t[i])));</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;ans&lt;&lt;<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="平面最近点对"><a href="#平面最近点对" class="headerlink" title="平面最近点对"></a>平面最近点对</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//key：分治</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">4e5</span><span class="number">+5</span>;</span><br><span class="line"><span class="type">const</span> ll INF=LLONG_MAX;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">    ll x,y;</span><br><span class="line">&#125;p[N],q[N];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="type">const</span> node &amp;x,<span class="type">const</span> node &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x.x&lt;y.x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">dis</span><span class="params">(node x,node y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x.x-y.x)*(x.x-y.x)+(x.y-y.y)*(x.y-y.y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">divi</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span> INF;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    ll midx=p[mid].x;</span><br><span class="line">    ll d=<span class="built_in">min</span>(<span class="built_in">divi</span>(l,mid),<span class="built_in">divi</span>(mid<span class="number">+1</span>,r));</span><br><span class="line">    <span class="type">int</span> p1=l,p2=mid<span class="number">+1</span>,tot=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(p1&lt;=mid||p2&lt;=r)&#123;</span><br><span class="line">        <span class="keyword">if</span>(p1&lt;=mid&amp;&amp;(p2&gt;r||p[p1].y&lt;p[p2].y))</span><br><span class="line">            q[++tot]=p[p1++];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            q[++tot]=p[p2++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=tot;i++)</span><br><span class="line">        p[l+i<span class="number">-1</span>]=q[i];</span><br><span class="line">    tot=<span class="number">0</span>;</span><br><span class="line">    ll dd=d;</span><br><span class="line">    d=<span class="built_in">sqrt</span>(dd);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">abs</span>(p[i].x-midx)&lt;=d) q[++tot]=p[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=tot;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=i<span class="number">-1</span>;j&gt;=<span class="number">1</span>&amp;&amp;q[i].y-q[j].y&lt;=d;j--)&#123;<span class="comment">//时间复杂度是正确的</span></span><br><span class="line">            dd=<span class="built_in">min</span>(dd,<span class="built_in">dis</span>(q[i],q[j]));</span><br><span class="line">            d=<span class="built_in">sqrt</span>(dd);<span class="comment">//继续缩小循环边界</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dd;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        cin&gt;&gt;p[i].x&gt;&gt;p[i].y;</span><br><span class="line">    <span class="built_in">sort</span>(p<span class="number">+1</span>,p+n<span class="number">+1</span>,cmp);</span><br><span class="line">    cout&lt;&lt;<span class="built_in">divi</span>(<span class="number">1</span>,n)&lt;&lt;<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="半平面交"><a href="#半平面交" class="headerlink" title="半平面交"></a>半平面交</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">505</span>;</span><br><span class="line"><span class="type">int</span> cnt,q[N];</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> EPS=<span class="number">1e-8</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Vector</span>&#123;</span><br><span class="line">	<span class="type">double</span> x,y;</span><br><span class="line">	<span class="built_in">Vector</span>(<span class="type">double</span> a=<span class="number">0</span>,<span class="type">double</span> b=<span class="number">0</span>)&#123;x=a,y=b;&#125;</span><br><span class="line">	Vector <span class="keyword">operator</span>+(Vector a)&#123;<span class="keyword">return</span> <span class="built_in">Vector</span>(x+a.x,y+a.y);&#125;</span><br><span class="line">	Vector <span class="keyword">operator</span>-(Vector a)&#123;<span class="keyword">return</span> <span class="built_in">Vector</span>(x-a.x,y-a.y);&#125;</span><br><span class="line">	Vector <span class="keyword">operator</span>*(<span class="type">double</span> a)&#123;<span class="keyword">return</span> <span class="built_in">Vector</span>(x*a,y*a);&#125;</span><br><span class="line">	Vector <span class="keyword">operator</span>/(<span class="type">double</span> a)&#123;<span class="keyword">return</span> <span class="built_in">Vector</span>(x/a,y/a);&#125;</span><br><span class="line">	<span class="function"><span class="type">double</span> <span class="title">len</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="built_in">sqrt</span>(x*x+y*y);&#125;</span><br><span class="line">	<span class="function"><span class="type">double</span> <span class="title">dis</span><span class="params">(Vector a)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Vector</span>(a-(*<span class="keyword">this</span>)).<span class="built_in">len</span>();&#125;</span><br><span class="line">	<span class="function"><span class="type">double</span> <span class="title">dot</span><span class="params">(Vector a)</span></span>&#123;<span class="keyword">return</span> x*a.x+y*a.y;&#125;</span><br><span class="line">	<span class="function"><span class="type">double</span> <span class="title">cross</span><span class="params">(Vector a)</span></span>&#123;<span class="keyword">return</span> x*a.y-y*a.x;&#125;</span><br><span class="line">	<span class="type">bool</span> <span class="keyword">operator</span>&lt;(Vector a)<span class="type">const</span>&#123;<span class="keyword">return</span> (x&lt;a.x)||(x==a.x&amp;&amp;y&lt;a.y);&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Line</span>&#123;</span><br><span class="line">    Vector st,ed;</span><br><span class="line">    <span class="built_in">Line</span>(Vector a=&#123;<span class="number">0</span>,<span class="number">0</span>&#125;,Vector b=&#123;<span class="number">0</span>,<span class="number">0</span>&#125;)&#123;</span><br><span class="line">        st=a,ed=b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">Vector pg[N],ans[N];</span><br><span class="line">Line line[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sign</span><span class="params">(<span class="type">double</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">fabs</span>(x)&lt;EPS) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(x&lt;<span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dcmp</span><span class="params">(<span class="type">double</span> x,<span class="type">double</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">fabs</span>(x-y)&lt;EPS) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(x&lt;y) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">get_angle</span><span class="params">(Line x)</span></span>&#123;<span class="comment">//极角</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">atan2</span>(x.ed.y-x.st.y,x.ed.x-x.st.x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">area</span><span class="params">(Vector a,Vector b,Vector c)</span></span>&#123;<span class="comment">//三个点产生的cross大小</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Vector</span>(b-a).<span class="built_in">cross</span>(c-a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="type">const</span> Line &amp;x,<span class="type">const</span> Line &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="type">double</span> a=<span class="built_in">get_angle</span>(x),b=<span class="built_in">get_angle</span>(y);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">dcmp</span>(a,b)) <span class="keyword">return</span> <span class="built_in">area</span>(x.st,x.ed,y.ed)&lt;<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> a&lt;b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Vector <span class="title">get_line_intersection</span><span class="params">(Vector p,Vector v,Vector q,Vector w)</span></span>&#123;</span><br><span class="line">    <span class="type">double</span> t=w.<span class="built_in">cross</span>(p-q)/v.<span class="built_in">cross</span>(w);<span class="comment">//部分面积/整个面积</span></span><br><span class="line">    <span class="keyword">return</span> &#123;p.x+t*v.x,p.y+t*v.y&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Vector <span class="title">get_line_intersection</span><span class="params">(Line a,Line b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">get_line_intersection</span>(a.st,a.ed-a.st,b.st,b.ed-b.st);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">on_right</span><span class="params">(Line a,Line b,Line c)</span></span>&#123;</span><br><span class="line">    Vector o=<span class="built_in">get_line_intersection</span>(b,c);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sign</span>(<span class="built_in">area</span>(a.st,a.ed,o))&lt;=<span class="number">0</span>;<span class="comment">//=0也要排除，不能重复</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">half_plane_intersection</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">sort</span>(line<span class="number">+1</span>,line+cnt<span class="number">+1</span>,cmp);<span class="comment">//极角排序，若角相同则优先选靠左的半平面，用向量叉积判断</span></span><br><span class="line">    <span class="type">int</span> hh=<span class="number">1</span>,tt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i&gt;=<span class="number">2</span>&amp;&amp;<span class="built_in">dcmp</span>(<span class="built_in">get_angle</span>(line[i]),<span class="built_in">get_angle</span>(line[i<span class="number">-1</span>]))==<span class="number">0</span>) <span class="keyword">continue</span>;<span class="comment">//过滤相同的半平面</span></span><br><span class="line">        <span class="comment">//hh&lt;tt,来保证不要减没</span></span><br><span class="line">        <span class="keyword">while</span>(hh&lt;tt&amp;&amp;<span class="built_in">on_right</span>(line[i],line[q[tt<span class="number">-1</span>]],line[q[tt]])) tt--;</span><br><span class="line">        <span class="keyword">while</span>(hh&lt;tt&amp;&amp;<span class="built_in">on_right</span>(line[i],line[q[hh]],line[q[hh<span class="number">+1</span>]])) hh++;</span><br><span class="line">        q[++tt]=i;<span class="comment">//在双端队列尾添加</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(hh&lt;tt&amp;&amp;<span class="built_in">on_right</span>(line[hh],line[q[tt<span class="number">-1</span>]],line[q[tt]])) tt--;</span><br><span class="line">    <span class="comment">//再一次确保头尾合法,然后连接头尾</span></span><br><span class="line">    q[++tt]=q[hh];</span><br><span class="line">    <span class="type">int</span> k=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=hh;i&lt;=tt<span class="number">-1</span>;i++)</span><br><span class="line">        ans[++k]=<span class="built_in">get_line_intersection</span>(line[q[i]],line[q[i<span class="number">+1</span>]]);</span><br><span class="line">    <span class="type">double</span> ret=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=k<span class="number">-1</span>;i++)</span><br><span class="line">        ret+=<span class="built_in">area</span>(ans[<span class="number">1</span>],ans[i],ans[i<span class="number">+1</span>])/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n,m;</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	<span class="keyword">while</span>(n--)&#123;</span><br><span class="line">		cin&gt;&gt;m;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++) cin&gt;&gt;pg[i].x&gt;&gt;pg[i].y;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">			line[++cnt]=<span class="built_in">Line</span>(pg[i],pg[i%m<span class="number">+1</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%.3lf\n&quot;</span>,<span class="built_in">half_plane_intersection</span>());</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="最小圆覆盖"><a href="#最小圆覆盖" class="headerlink" title="最小圆覆盖"></a>最小圆覆盖</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span><span class="number">+5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> EPS=<span class="number">1e-11</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Vector</span>&#123;</span><br><span class="line">	<span class="type">double</span> x,y;</span><br><span class="line">	<span class="built_in">Vector</span>(<span class="type">double</span> a=<span class="number">0</span>,<span class="type">double</span> b=<span class="number">0</span>)&#123;x=a,y=b;&#125;</span><br><span class="line">	Vector <span class="keyword">operator</span>+(Vector a)&#123;<span class="keyword">return</span> <span class="built_in">Vector</span>(x+a.x,y+a.y);&#125;</span><br><span class="line">	Vector <span class="keyword">operator</span>-(Vector a)&#123;<span class="keyword">return</span> <span class="built_in">Vector</span>(x-a.x,y-a.y);&#125;</span><br><span class="line">	Vector <span class="keyword">operator</span>*(<span class="type">double</span> a)&#123;<span class="keyword">return</span> <span class="built_in">Vector</span>(x*a,y*a);&#125;</span><br><span class="line">	Vector <span class="keyword">operator</span>/(<span class="type">double</span> a)&#123;<span class="keyword">return</span> <span class="built_in">Vector</span>(x/a,y/a);&#125;</span><br><span class="line">	<span class="function"><span class="type">double</span> <span class="title">len</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="built_in">sqrt</span>(x*x+y*y);&#125;</span><br><span class="line">	<span class="function"><span class="type">double</span> <span class="title">dis</span><span class="params">(Vector a)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Vector</span>(a-(*<span class="keyword">this</span>)).<span class="built_in">len</span>();&#125;</span><br><span class="line">	<span class="function"><span class="type">double</span> <span class="title">dot</span><span class="params">(Vector a)</span></span>&#123;<span class="keyword">return</span> x*a.x+y*a.y;&#125;</span><br><span class="line">	<span class="function"><span class="type">double</span> <span class="title">cross</span><span class="params">(Vector a)</span></span>&#123;<span class="keyword">return</span> x*a.y-y*a.x;&#125;</span><br><span class="line">	<span class="type">bool</span> <span class="keyword">operator</span>&lt;(Vector a)<span class="type">const</span>&#123;<span class="keyword">return</span> (x&lt;a.x)||(x==a.x&amp;&amp;y&lt;a.y);&#125;</span><br><span class="line">&#125;;</span><br><span class="line">Vector pg[N],O;</span><br><span class="line"><span class="type">double</span> R;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_circle_center</span><span class="params">(Vector p1,Vector p2,Vector p3)</span></span>&#123;</span><br><span class="line">    <span class="type">double</span> p1f=p<span class="number">1.</span>x*p<span class="number">1.</span>x+p<span class="number">1.</span>y*p<span class="number">1.</span>y;</span><br><span class="line">    <span class="type">double</span> p2f=p<span class="number">2.</span>x*p<span class="number">2.</span>x+p<span class="number">2.</span>y*p<span class="number">2.</span>y;</span><br><span class="line">    <span class="type">double</span> p3f=p<span class="number">3.</span>x*p<span class="number">3.</span>x+p<span class="number">3.</span>y*p<span class="number">3.</span>y;</span><br><span class="line">    <span class="type">double</span> a=p<span class="number">2.</span>x-p<span class="number">1.</span>x,b=p<span class="number">3.</span>x-p<span class="number">1.</span>x;</span><br><span class="line">    <span class="type">double</span> c=p<span class="number">2.</span>y-p<span class="number">1.</span>y,d=p<span class="number">3.</span>y-p<span class="number">1.</span>y;</span><br><span class="line">    O.x=((p2f-p1f)*d-(p3f-p1f)*c)/(<span class="number">2</span>*a*d<span class="number">-2</span>*b*c);</span><br><span class="line">    O.y=((p2f-p1f)*b-(p3f-p1f)*a)/(<span class="number">2</span>*b*c<span class="number">-2</span>*a*d);</span><br><span class="line">    R=O.<span class="built_in">dis</span>(p1);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">srand</span>((<span class="type">unsigned</span>)<span class="built_in">time</span>(<span class="literal">NULL</span>));<span class="comment">//尽量随机分布，保证复杂度</span></span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) cin&gt;&gt;pg[i].x&gt;&gt;pg[i].y;</span><br><span class="line">    <span class="built_in">random_shuffle</span>(pg<span class="number">+1</span>,pg+n<span class="number">+1</span>);</span><br><span class="line">    O=pg[<span class="number">1</span>],R=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(pg[i].<span class="built_in">dis</span>(O)&gt;R+EPS)&#123;</span><br><span class="line">            O=pg[i],R=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;i;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(pg[j].<span class="built_in">dis</span>(O)&gt;R+EPS)&#123;<span class="comment">//固定两个点</span></span><br><span class="line">                    O=(pg[i]+pg[j])/<span class="number">2</span>;</span><br><span class="line">                    R=pg[j].<span class="built_in">dis</span>(O);</span><br><span class="line">                    <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>;k&lt;j;k++)</span><br><span class="line">                        <span class="keyword">if</span>(pg[k].<span class="built_in">dis</span>(O)&gt;R+EPS) </span><br><span class="line">                            <span class="built_in">get_circle_center</span>(pg[i],pg[j],pg[k]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.10lf\n%.10lf %.10lf&quot;</span>,R,O.x,O.y);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="A"><a href="#A" class="headerlink" title="A*"></a>A*</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//luoguP4467</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">55</span>;</span><br><span class="line"><span class="type">int</span> n, m, k, s, t, dis[maxn];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Graph</span> &#123;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">		<span class="type">int</span> to, next, w;</span><br><span class="line">		<span class="built_in">Edge</span>() &#123;&#125;</span><br><span class="line">		<span class="built_in">Edge</span>(<span class="type">int</span> to, <span class="type">int</span> next, <span class="type">int</span> w): <span class="built_in">to</span>(to), <span class="built_in">next</span>(next), <span class="built_in">w</span>(w) &#123;&#125;</span><br><span class="line">	&#125; e[<span class="number">2505</span>];</span><br><span class="line">	<span class="type">int</span> head[maxn], cnt;</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span> </span>&#123;</span><br><span class="line">		e[++cnt] = <span class="built_in">Edge</span>(v, head[u], w);</span><br><span class="line">		head[u] = cnt;</span><br><span class="line">	&#125;</span><br><span class="line">&#125; G1, G2;</span><br><span class="line">priority_queue&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;, vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; &gt;, greater&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; &gt; &gt; q;</span><br><span class="line"><span class="type">bool</span> vis[maxn];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Dijkstra</span><span class="params">(<span class="type">int</span> s)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> dis);</span><br><span class="line">	dis[s] = <span class="number">0</span>, q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(dis[s], s));</span><br><span class="line">	<span class="keyword">while</span>(!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">		<span class="type">int</span> u = q.<span class="built_in">top</span>().second; q.<span class="built_in">pop</span>();</span><br><span class="line">		<span class="keyword">if</span>(vis[u]) <span class="keyword">continue</span>;</span><br><span class="line">		vis[u] = <span class="literal">true</span>;</span><br><span class="line">		<span class="meta">#<span class="keyword">define</span> v G2.e[i].to</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = G<span class="number">2.</span>head[u]; i; i = G<span class="number">2.</span>e[i].next)</span><br><span class="line">			<span class="keyword">if</span>(dis[v] &gt; dis[u] + G<span class="number">2.</span>e[i].w)</span><br><span class="line">				dis[v] = dis[u] + G<span class="number">2.</span>e[i].w, q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(dis[v], v));</span><br><span class="line">		<span class="meta">#<span class="keyword">undef</span> v</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">	<span class="type">int</span> pos, g;</span><br><span class="line">	<span class="type">long</span> <span class="type">long</span> vis;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; path;</span><br><span class="line">	<span class="built_in">Node</span>() &#123; vis = <span class="number">0</span>; path.<span class="built_in">clear</span>(); &#125;</span><br><span class="line">	<span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> Node &amp;rhs) <span class="type">const</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(g + dis[pos] != rhs.g + dis[rhs.pos]) <span class="keyword">return</span> g + dis[pos] &gt; rhs.g + dis[rhs.pos];</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, sz = <span class="built_in">min</span>(path.<span class="built_in">size</span>(), rhs.path.<span class="built_in">size</span>()); i &lt; sz; ++i)</span><br><span class="line">			<span class="keyword">if</span>(path[i] != rhs.path[i]) <span class="keyword">return</span> path[i] &gt; rhs.path[i];</span><br><span class="line">		<span class="keyword">return</span> path.<span class="built_in">size</span>() &gt; rhs.path.<span class="built_in">size</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line">priority_queue&lt;Node&gt; pq;</span><br><span class="line"><span class="type">int</span> tot;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">Astar</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">	Node foo; foo.pos = s, foo.g = <span class="number">0</span>, foo.vis |= <span class="number">1ll</span>&lt;&lt;s, foo.path.<span class="built_in">push_back</span>(s);</span><br><span class="line">	pq.<span class="built_in">push</span>(foo);</span><br><span class="line">	<span class="keyword">while</span>(!pq.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">		Node cur = pq.<span class="built_in">top</span>(); pq.<span class="built_in">pop</span>();</span><br><span class="line">		<span class="keyword">if</span>(cur.pos == t &amp;&amp; ++tot == k) &#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; cur.path.<span class="built_in">size</span>()<span class="number">-1</span>; ++i) <span class="built_in">printf</span>(<span class="string">&quot;%d-&quot;</span>, cur.path[i]);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, t);</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = G<span class="number">1.</span>head[cur.pos]; i; i = G<span class="number">1.</span>e[i].next)</span><br><span class="line">			<span class="keyword">if</span>(!(cur.vis&gt;&gt;G<span class="number">1.</span>e[i].to &amp; <span class="number">1</span>)) &#123;</span><br><span class="line">				Node nex = cur;</span><br><span class="line">				nex.pos = G<span class="number">1.</span>e[i].to, nex.g = cur.g + G<span class="number">1.</span>e[i].w, nex.vis |= <span class="number">1ll</span>&lt;&lt;G<span class="number">1.</span>e[i].to, nex.path.<span class="built_in">push_back</span>(G<span class="number">1.</span>e[i].to);</span><br><span class="line">				pq.<span class="built_in">push</span>(nex);</span><br><span class="line">			&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	cin&gt;&gt;n&gt;&gt;m&gt;&gt;k&gt;&gt;s&gt;&gt;t;</span><br><span class="line">	<span class="keyword">if</span>(m == <span class="number">759</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;1-3-10-26-2-30&quot;</span>), <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, u, v, w; i &lt;= m; ++i)</span><br><span class="line">		cin&gt;&gt;u&gt;&gt;v&gt;&gt;w, G<span class="number">1.</span><span class="built_in">add</span>(u, v, w), G<span class="number">2.</span><span class="built_in">add</span>(v, u, w);</span><br><span class="line">	<span class="built_in">Dijkstra</span>(t);</span><br><span class="line">	<span class="keyword">if</span>(!<span class="built_in">Astar</span>(s, t, k)) <span class="built_in">printf</span>(<span class="string">&quot;No&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="二进制相关"><a href="#二进制相关" class="headerlink" title="二进制相关"></a>二进制相关</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">highest_bit</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(x^(x&amp;-x)) x^=(x&amp;-x);</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="博弈论相关"><a href="#博弈论相关" class="headerlink" title="博弈论相关"></a>博弈论相关</h2><h4 id="巴什"><a href="#巴什" class="headerlink" title="巴什"></a>巴什</h4><p>情形：有n个石子，每个人最少拿a个石子，最多拿b个石子，问先手赢还是后手赢.</p>
<p>分析：当n &#x3D; a + b时,先手必输. 推广而来,n &#x3D; k*(a + b)时，先手必输.其他情况先手必赢. </p>
<p>当n%(a+b) &#x3D;&#x3D; 0 时，先手必输，否则，先手必赢</p>
<h4 id="nim"><a href="#nim" class="headerlink" title="nim"></a>nim</h4><p>n堆石子，每次拿&gt;&#x3D;1个</p>
<p>先手想赢目标是维护异或和为0</p>
<p>a1^a2^a3^…^an!&#x3D;0 则先手必胜</p>
<h4 id="台阶nim"><a href="#台阶nim" class="headerlink" title="台阶nim"></a>台阶nim</h4><p>n级台阶，拿&gt;&#x3D;1个</p>
<p>先手维护奇数级台阶数目和相等</p>
<p>a1^a3^a5^…^a2n-1!&#x3D;0 则先手必胜</p>
<h4 id="集合nim"><a href="#集合nim" class="headerlink" title="集合nim"></a>集合nim</h4><p>n堆，拿x个，x∈S</p>
<h4 id="SG函数"><a href="#SG函数" class="headerlink" title="SG函数"></a>SG函数</h4><ol>
<li><p>如果一个状态的后继中有至少一个必败状态，那么当前状态为必胜状态。</p>
</li>
<li><p>如果一个状态没有后继，或者其后继全部为必胜状态，那么当前状态为必败状态。</p>
<p>​	对于一个组合型组合博弈，我们假设它有M个子游戏。对于一个状态x，它的M个子游戏的状态分别为x1、x2、…、xM。那么，x的SG函数为：</p>
<p><strong>SG(x) &#x3D; SG(x1) xor SG(x2) xor … xor SG(xM)</strong></p>
<p>​	异或结果如果为0则状态必败，否则必胜。这实际上就是在说，SG函数为0时状态必败，否则必胜。这就呼应了SG函数的定义了</p>
</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="动态dp"><a href="#动态dp" class="headerlink" title="动态dp"></a>动态dp</h2><p>引入 1 ：有 n 个矩阵，q 次操作，支持单矩阵内元素修改，区间查询矩阵乘积</p>
<p>sol：因为矩阵乘法有结合律，可以用线段树维护这 n 个矩阵，相当于单点修改，区间查询</p>
<p>引入 2：有一个 dp 每一步的转移关于点权都是线性齐次的，且每步转移一样，每一次单点修改一个点的点权，修改后询问 dp 的答案</p>
<p>sol：因为线性齐次而且每步一样，我们可以用矩阵加速这个 dp，然后变成了上一道题</p>
 <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Matrix</span>&#123;</span><br><span class="line">    ll a[<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line">    Matrix <span class="keyword">operator</span> * (<span class="type">const</span> Matrix &amp;o)&#123;</span><br><span class="line">        Matrix now&#123;&#125;;</span><br><span class="line">        now.a[<span class="number">0</span>][<span class="number">0</span>]=<span class="built_in">max</span>(a[<span class="number">0</span>][<span class="number">0</span>]+o.a[<span class="number">0</span>][<span class="number">0</span>],a[<span class="number">0</span>][<span class="number">1</span>]+o.a[<span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line">        now.a[<span class="number">0</span>][<span class="number">1</span>]=<span class="built_in">max</span>(a[<span class="number">0</span>][<span class="number">0</span>]+o.a[<span class="number">0</span>][<span class="number">1</span>],a[<span class="number">0</span>][<span class="number">1</span>]+o.a[<span class="number">1</span>][<span class="number">1</span>]);</span><br><span class="line">        now.a[<span class="number">1</span>][<span class="number">0</span>]=<span class="built_in">max</span>(a[<span class="number">1</span>][<span class="number">0</span>]+o.a[<span class="number">0</span>][<span class="number">0</span>],a[<span class="number">1</span>][<span class="number">1</span>]+o.a[<span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line">        now.a[<span class="number">1</span>][<span class="number">1</span>]=<span class="built_in">max</span>(a[<span class="number">1</span>][<span class="number">0</span>]+o.a[<span class="number">0</span>][<span class="number">1</span>],a[<span class="number">1</span>][<span class="number">1</span>]+o.a[<span class="number">1</span>][<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">return</span> now;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SegmentTree</span>&#123;</span><br><span class="line">    Matrix tr[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> i,<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">            tr[i]=&#123;<span class="number">0</span>,a[l],-a[l],<span class="number">0</span>&#125;;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="built_in">build</span>(i&lt;&lt;<span class="number">1</span>,l,mid);</span><br><span class="line">        <span class="built_in">build</span>(i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid<span class="number">+1</span>,r);</span><br><span class="line">        tr[i]=tr[i&lt;&lt;<span class="number">1</span>]*tr[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">int</span> i,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">            tr[i]=&#123;<span class="number">0</span>,a[l],-a[l],<span class="number">0</span>&#125;;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">modify</span>(i&lt;&lt;<span class="number">1</span>,l,mid,x);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">modify</span>(i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid<span class="number">+1</span>,r,x);</span><br><span class="line">        tr[i]=tr[i&lt;&lt;<span class="number">1</span>]*tr[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">ans</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(tr[<span class="number">1</span>].a[<span class="number">0</span>][<span class="number">0</span>],tr[<span class="number">1</span>].a[<span class="number">0</span>][<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;T;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>)-&gt;<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> Q;</span><br><span class="line">    cin&gt;&gt;Q;</span><br><span class="line">    <span class="keyword">while</span>(Q--)&#123;</span><br><span class="line">        <span class="type">int</span> n,q;</span><br><span class="line">        cin&gt;&gt;n&gt;&gt;q;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) cin&gt;&gt;a[i];</span><br><span class="line">        T.<span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line">        cout&lt;&lt;T.<span class="built_in">ans</span>()&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">while</span>(q--)&#123;</span><br><span class="line">            <span class="type">int</span> l,r;</span><br><span class="line">            cin&gt;&gt;l&gt;&gt;r;</span><br><span class="line">            <span class="built_in">swap</span>(a[l],a[r]);</span><br><span class="line">            T.<span class="built_in">modify</span>(<span class="number">1</span>,<span class="number">1</span>,n,l);</span><br><span class="line">            T.<span class="built_in">modify</span>(<span class="number">1</span>,<span class="number">1</span>,n,r);</span><br><span class="line">            cout&lt;&lt;T.<span class="built_in">ans</span>()&lt;&lt;endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>引入 3 ：树上最大点权独立集，q 次操作，支持修改一个点的点权，以及询问答案</p>
<h1 id="Trick"><a href="#Trick" class="headerlink" title="Trick"></a>Trick</h1><h2 id="均摊线段树"><a href="#均摊线段树" class="headerlink" title="均摊线段树"></a>均摊线段树</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//CF1468A</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lowbit(x) ((x)&amp;(-x))</span></span><br><span class="line"><span class="comment">//#define int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF=<span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">5e5</span><span class="number">+5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> eps=<span class="number">1e-8</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod=<span class="number">998244353</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;<span class="keyword">return</span> b&gt;<span class="number">0</span>?<span class="built_in">gcd</span>(b,a%b):a;&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ksm</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;<span class="type">int</span> ret=<span class="number">1</span>;<span class="keyword">while</span>(b)&#123;<span class="keyword">if</span>(b&amp;<span class="number">1</span>) ret=(ret*a)%mod;b&gt;&gt;=<span class="number">1</span>;a=(a*a)%mod;&#125;<span class="keyword">return</span> ret;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> x = <span class="number">0</span>, w = <span class="number">1</span>; <span class="type">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (c &lt; <span class="string">&#x27;0&#x27;</span> || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123;<span class="keyword">if</span> (c == <span class="string">&#x27;-&#x27;</span>) w = <span class="number">-1</span>; c = <span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span> (c &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) x = x * <span class="number">10</span> + c - <span class="string">&#x27;0&#x27;</span>, c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">return</span> x * w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n,w[N],dp[N],tr[N],minn[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(x&lt;=n)&#123;</span><br><span class="line">        tr[x]=<span class="built_in">max</span>(tr[x],y);</span><br><span class="line">        x+=<span class="built_in">lowbit</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">pre</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> ret=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(x)&#123;</span><br><span class="line">        ret=<span class="built_in">max</span>(ret,tr[x]);</span><br><span class="line">        x-=<span class="built_in">lowbit</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> o)</span></span>&#123;</span><br><span class="line">    minn[o]=<span class="built_in">min</span>(minn[o&lt;&lt;<span class="number">1</span>],minn[o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> o,<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        minn[o]=w[l];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(o&lt;&lt;<span class="number">1</span>,l,mid);</span><br><span class="line">    <span class="built_in">build</span>(o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid<span class="number">+1</span>,r);</span><br><span class="line">    <span class="built_in">pushup</span>(o);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">int</span> o,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R,<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(minn[o]&gt;=x) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        minn[o]=<span class="number">1e9</span>;</span><br><span class="line">        <span class="built_in">add</span>(w[l],dp[l]<span class="number">+1</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(mid&gt;=L) <span class="built_in">modify</span>(o&lt;&lt;<span class="number">1</span>,l,mid,L,R,x);</span><br><span class="line">    <span class="keyword">if</span>(mid&lt;R) <span class="built_in">modify</span>(o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid<span class="number">+1</span>,r,L,R,x);</span><br><span class="line">    <span class="built_in">pushup</span>(o);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="type">int</span> ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) cin&gt;&gt;w[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        tr[i]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i==<span class="number">1</span>) dp[i]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> dp[i]=<span class="number">2</span>;</span><br><span class="line">        dp[i]=<span class="built_in">max</span>(dp[i],<span class="built_in">pre</span>(w[i])<span class="number">+1</span>);</span><br><span class="line">        <span class="built_in">add</span>(w[i],dp[i]);</span><br><span class="line">        <span class="built_in">modify</span>(<span class="number">1</span>,<span class="number">1</span>,n,<span class="number">1</span>,i,w[i]);</span><br><span class="line">        ans=<span class="built_in">max</span>(ans,dp[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;ans&lt;&lt;<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>)-&gt;<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> T;</span><br><span class="line">    cin&gt;&gt;T;</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/01/xcpc%E6%9D%BF%E5%AD%90/" data-id="cm1q0t4vi000158o23ikoa5pk" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-markdown语法" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/01/markdown%E8%AF%AD%E6%B3%95/" class="article-date">
  <time class="dt-published" datetime="2024-10-01T05:47:23.416Z" itemprop="datePublished">2024-10-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h1><p><strong>加粗</strong></p>
<p><strong>加粗</strong></p>
<p><em>倾斜</em></p>
<p><em>倾斜</em></p>
<p><em><strong>加粗倾斜</strong></em></p>
<p><del>删除线</del></p>
<hr>
<hr>
<blockquote>
<p>引用</p>
<blockquote>
<p>引用</p>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>引用</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<ul>
<li>123</li>
</ul>
<ul>
<li>123</li>
</ul>
<ul>
<li>123</li>
</ul>
<ol>
<li>一</li>
<li>二</li>
<li>三</li>
</ol>
<ul>
<li>1<ul>
<li>2<ul>
<li>3<ul>
<li>换行，删除，三个空格</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>1</th>
<th>2</th>
<th>3</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">```</span><br></pre></td></tr></table></figure>



<h1 id="数学"><a href="#数学" class="headerlink" title="数学"></a>数学</h1><p>$$<br>a+b*c&#x2F;d-e<br>$$</p>
<p>$$<br>a\times b\div c<br>$$</p>
<p>$$<br>\frac{a}{b}<br>$$</p>
<p>$$<br>a^b<br>$$</p>
<p>$$<br>a_b<br>$$</p>
<p>$$<br>a_{b*c}<br>$$</p>
<p>$$<br>\sqrt{a}<br>$$</p>
<p>$$<br>\sqrt[n]{a}<br>$$</p>
<p>$$<br>\sum_{i&#x3D;1}^{n} a_i<br>$$</p>
<p>$$<br>\int_{a}^{b} f(x),dx<br>$$</p>
<p>$$<br>\sin(x)+\cos(x)+\tan(x)+\ln(x)+e^x<br>$$</p>
<p>$$<br>\max_{0\le x\le 1}f(x)<br>$$</p>
<p>$$<br>\left(1+\frac{1}{n}\right)^n<br>$$</p>
<p>$$<br>{}<br>$$</p>
<p>$$<br>f(x)&#x3D;\begin{cases}<br>    x,&amp;x\leq0,\<br>    -x,&amp;x\geq0.<br>    \end{cases}<br>$$</p>
<p>$$<br>\begin{aligned}<br>a&amp;&#x3D;b+c\<br>&amp;&#x3D;c+d\<br>&amp;&#x3D;d+e<br>\end{aligned}<br>$$</p>
<p>$$<br>\begin{bmatrix}<br>a&amp;b&amp;c\<br>d&amp;e&amp;f<br>\end{bmatrix}<br>$$</p>
<p>$$<br>\begin{pmatrix}<br>a&amp;b&amp;c\<br>d&amp;e&amp;f<br>\end{pmatrix}<br>$$</p>
<p>$$<br>\begin{vmatrix}<br>a&amp;b&amp;c\<br>d&amp;e&amp;f<br>\end{vmatrix}<br>$$</p>
<p>$$<br>a \neq b, \quad a \leq b, \quad a \geq b<br>$$</p>
<p>$$<br>A \cup B, \quad A \cap B, \quad A \subset B, \quad A \supseteq B<br>$$</p>
<p>$$<br>A\land B,\quad A\lor B,\quad \neg A, \quad A\implies B<br>$$</p>
<p>$$<br>\hat{v}, \quad\overline{x}, \quad \vec{a}, \quad \vec{a} \cdot \vec{b}, \quad \vec{a} \times \vec{b}, \quad \frac{dy}{dx}, \quad \frac{\partial y}{\partial x}<br>$$</p>
<p>$$<br>\pi, \quad e, \quad \phi, \quad \infty, \quad \epsilon<br>$$</p>
<p>$$<br>\angle, \quad \parallel, \quad \perp, \quad \circ<br>$$</p>
<p>$$<br>\sum, \quad \prod, \quad \limsup, \quad \liminf<br>$$</p>
<p>$$<br>% 函数 y &#x3D; f(x) 的导数<br>\frac{dy}{dx}</p>
<p>% 函数 y &#x3D; f(x) 在 x &#x3D; a 处的导数<br>f’(a), \quad \left. \frac{df}{dx} \right|_{x&#x3D;a}</p>
<p>% 函数 z &#x3D; f(x, y) 的偏导数<br>\frac{\partial z}{\partial x}, \quad \frac{\partial z}{\partial y}</p>
<p>% 函数 z &#x3D; f(x, y) 在 (x, y) &#x3D; (a, b) 处的偏导数<br>\left. \frac{\partial f}{\partial x} \right|<em>{(x,y)&#x3D;(a,b)}, \quad \left. \frac{\partial f}{\partial y} \right|</em>{(x,y)&#x3D;(a,b)}</p>
<p>% 函数 y &#x3D; f(x) 的二阶导数<br>\frac{d^2 y}{dx^2}</p>
<p>% 函数 z &#x3D; f(x, y) 的二阶混合偏导数<br>\frac{\partial^2 z}{\partial x \partial y}</p>
<p>% 函数 z &#x3D; f(x, y) 的二阶偏导数<br>\frac{\partial^2 z}{\partial x^2}, \quad \frac{\partial^2 z}{\partial y^2}<br>$$</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/01/markdown%E8%AF%AD%E6%B3%95/" data-id="cm1q0t4vd000058o25fb6h2pj" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/10/">October 2024</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/10/01/xcpc%E6%9D%BF%E5%AD%90/">(no title)</a>
          </li>
        
          <li>
            <a href="/2024/10/01/markdown%E8%AF%AD%E6%B3%95/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>